<!DOCTYPE html>
<html lang="en">

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Osnovni koncepti programiranja Java/SQL aplikacija sa dinamičkim SQL naredbama (JDBC) | Programiranje Db2 baza podataka</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Osnovni koncepti programiranja Java/SQL aplikacija sa dinamičkim SQL naredbama (JDBC)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Elektronska knjiga “Programiranje Db2 baza podataka” dostupna besplatno na adresi" />
<meta property="og:description" content="Elektronska knjiga “Programiranje Db2 baza podataka” dostupna besplatno na adresi" />
<link rel="canonical" href="https://theikeofficial.github.io//PDb2BP/poglavlja/8/" />
<meta property="og:url" content="https://theikeofficial.github.io//PDb2BP/poglavlja/8/" />
<meta property="og:site_name" content="Programiranje Db2 baza podataka" />
<script type="application/ld+json">
{"description":"Elektronska knjiga “Programiranje Db2 baza podataka” dostupna besplatno na adresi","@type":"WebPage","url":"https://theikeofficial.github.io//PDb2BP/poglavlja/8/","headline":"Osnovni koncepti programiranja Java/SQL aplikacija sa dinamičkim SQL naredbama (JDBC)","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/PDb2BP/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://theikeofficial.github.io//PDb2BP/feed.xml" title="Programiranje Db2 baza podataka" /></head>
<body><header class="site-header" role="banner"
    style="background-image: url(/PDb2BP/resources/header.png); height: 300px; background-repeat: repeat-x;"><a class="site-title" rel="author" href="/PDb2BP/"
        style="display: flex; position: relative; top: 125px; background-color: white; width: 100%; height: 86px;flex-wrap: wrap; justify-content: center; align-items: center; line-height: 0px; font-size: 36px;">
        
        
        <span style="font-weight: bold;">PROGRAMIRANJE&nbsp;</span>
        
        <span style="font-weight: bold;">DB2&nbsp;</span>
        
        <span style="font-weight: bold;">BAZA&nbsp;</span>
        
        <span style="font-weight: bold;">PODATAKA&nbsp;</span>
        
    </a>
</header><main class="page-content" aria-label="Content">
        <div class="wrapper" style="max-width: calc(1100px - (30px * 2));">
            <article class="post">

  <header class="post-header">
    <h1 class="post-title">8. Osnovni koncepti programiranja Java/SQL aplikacija sa dinamičkim SQL naredbama (JDBC)</h1>
  </header>

  <div class="post-content">
    <p>Java Database Connectivity (JDBC) is a Java programming API that standardizes the
means to work and access databases. In JDBC the code is easily portable between several
RDBMS vendors. The only changes required to the code are normally which JDBC driver
to load and the connection string. JDBC uses only dynamic SQL and it is very popular.</p>

<p>Before you can execute SQL statements in any SQL program, you must be connected to a data source.</p>

<p><img src="/PDb2BP/poglavlja/8/Slike/jdbc.png" alt="" /></p>

<p>Though there are several types of JDBC drivers such as type 1, 2, 3 and 4; type 1 and 3
are not commonly used, and DB2’s support of these types has been deprecated. For type
2, there are two drivers as we will describe shortly, but one of them is also deprecated.</p>

<p>Type 2 and type 4 are supported with DB2 software, as shown in Table 9.1. Type 2 drivers
need to have a DB2 client installed, as the driver uses it to establish communication to
the database. Type 4 is a pure Java client, so there is no need for a DB2 client, but the
driver must be installed on the machine where the JDBC application is running.</p>

<table>
  <thead>
    <tr>
      <th>Driver Type</th>
      <th>Driver Name</th>
      <th>Packaged as</th>
      <th>Supports</th>
      <th>Minimum level of SDK for Java required</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Type 2</td>
      <td>DB2 JDBC Type 2 Driver for Linux, UNIX® and Windows (Deprecated)</td>
      <td>db2java.zip</td>
      <td>JDBC 1.2 and JDBC 2.0</td>
      <td>1.4.2</td>
    </tr>
    <tr>
      <td>Type 2 and Type 4</td>
      <td>IBM Data Server Driver for JDBC and SQLJ</td>
      <td>db2jcc.jar and sqlj.zip</td>
      <td>JDBC 3.0 compliant</td>
      <td>1.4.2</td>
    </tr>
    <tr>
      <td>Type 2 and Type 4</td>
      <td>IBM Data Server Driver for JDBC and SQLJ</td>
      <td>db2jcc4.jar and sqlj4.zip</td>
      <td>JDBC 4.0 and earlier</td>
      <td>6</td>
    </tr>
  </tbody>
</table>

<p>As mentioned earlier and shown also in Table 9.1, Type 2 is provided with two different
drivers; however the DB2 JDBC Type 2 Driver for Linux, UNIX and Windows, with
filename db2java.zip is deprecated.</p>

<p>When you install a DB2 server, a DB2 client or the IBM Data Server Driver for JDBC and
SQLJ, the db2jcc.jar and sqlj.zip files compliant with JDBC 3.0 are automatically added
to your classpath.</p>

<h2 id="81-kreiranje-konekcije">8.1 Kreiranje konekcije</h2>

<p>A connection to a database can be obtained using the DriverManager class of the java.sql
package.</p>

<p>Java.sql package defines the classes and interfaces required for the JDBC program to access
the relation data stored in a database. These APIs can be used to connect to the relational
database and manipulate the data (insert, update, delete, and so on) stored in tabular
form using the SQL standard. The interfaces defined in this package are implemented by
the driver specific classes and the definition can differ from vendor to vendor.</p>

<p>Before getting connection, the driver specific classes must be loaded and registered to the
<code class="language-plaintext highlighter-rouge">DriverManager</code>. Any number of drivers can be loaded and registered with the <code class="language-plaintext highlighter-rouge">DriverManager</code> using the <code class="language-plaintext highlighter-rouge">forName</code> method:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">ProgramName</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"com.ibm.db2.jcc.DB2Driver"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Java supports a special block, called static block (also called static clause) which can be
used for static initializations of a class. This code inside static block is executed only
once: the first time you make an object of that class or the first time you access a static
member of that class (even if you never make an object of that class). We will be using
static blocks in our programs to load and register DB2 JDBC driver, as shown in the code
example above.</p>

<p>The <code class="language-plaintext highlighter-rouge">forName</code> method take a string argument whose value is the name of the package which
implements the interfaces defined in <code class="language-plaintext highlighter-rouge">java.sql</code> package.</p>

<p>The connection to a database can be obtained by calling the <code class="language-plaintext highlighter-rouge">getConnection</code> method of
<code class="language-plaintext highlighter-rouge">DriverManager</code> class. This method takes a string value (URL) as an input, which gives
the information required to connect to the database. A typical URL format for Type 4
driver is:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jdbc:db2://&lt;servername&gt;:&lt;port number&gt;/&lt;database name&gt;
</code></pre></div></div>

<p>The connection to a database is closed by calling <code class="language-plaintext highlighter-rouge">close</code> method of <code class="language-plaintext highlighter-rouge">Connection</code> class.</p>

<p>The code in the following example returns the connection as <code class="language-plaintext highlighter-rouge">Connection</code> class object:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span> <span class="n">argv</span><span class="o">[])</span> <span class="o">{</span>
    <span class="nc">Connection</span> <span class="n">con</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="nc">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"jdbc:db2://localhost:50001/vstud"</span><span class="o">;</span>
    
    <span class="c1">// Open database connection</span>
    <span class="n">con</span> <span class="o">=</span> <span class="nc">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="s">"student"</span><span class="o">,</span> <span class="s">"abcdef"</span><span class="o">);</span>

    <span class="c1">// Do something...</span>

    <span class="c1">// Close database connection</span>
    <span class="n">con</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Možemo koristiti i try-with-resources naredbu u okviru koje ćemo otvoriti konekciju. Naredba se stara o otvorenim resursima i na kraju ih automatski zatvara. Neophodno je da deklarisani resursi implementiraju interfejs <code class="language-plaintext highlighter-rouge">AutoClosable</code>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span> <span class="n">argv</span><span class="o">[])</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"jdbc:db2://localhost:50001/vstud"</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">(</span><span class="nc">Connection</span> <span class="n">con</span> <span class="o">=</span> <span class="nc">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="s">"student"</span><span class="o">,</span> <span class="s">"abcdef"</span><span class="o">))</span> <span class="o">{</span>

        <span class="c1">// Do something...</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="82-obrada-sql-grešaka">8.2 Obrada SQL grešaka</h2>

<p>Just like any Java program, in JDBC, exception handling is done using the try-catch
block. A DB2 application throws a <code class="language-plaintext highlighter-rouge">SQLException</code> whenever it encounters a SQL error or
a <code class="language-plaintext highlighter-rouge">SQLWarning</code> whenever it encounters a SQL warning when executing SQL statements.</p>

<p>An object of <code class="language-plaintext highlighter-rouge">SQLException</code> is created and thrown whenever an error occurs while accessing
the database. The <code class="language-plaintext highlighter-rouge">SQLException</code> object provides the information listed in Table 11.1.</p>

<table>
  <thead>
    <tr>
      <th>SQLException information</th>
      <th>Description</th>
      <th>Method to retrieve this information</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Message</td>
      <td>Textual representation of the error code.</td>
      <td>getMessage</td>
    </tr>
    <tr>
      <td>SQLState</td>
      <td>The SQLState string.</td>
      <td>getSQLState</td>
    </tr>
    <tr>
      <td>ErrorCode</td>
      <td>An integer value that indicates the error which caused the exception to be thrown.</td>
      <td>getErrorCode</td>
    </tr>
  </tbody>
</table>

<p>Apart from the above information, the DB2 JCC driver provides an extra interface
<code class="language-plaintext highlighter-rouge">com.ibm.db2.jcc.DB2Diagnosable</code>. This interface gives more information regarding the
error that occurred while accessing the DB2 database.</p>

<p>If multiple <code class="language-plaintext highlighter-rouge">SQLExceptions</code> are thrown, they are chained. The next exception information
can be retrieved by calling the getNextException method of the current <code class="language-plaintext highlighter-rouge">SQLException</code>
object. This method will return null if the current <code class="language-plaintext highlighter-rouge">SQLException</code> object is last in the
chain. A while loop in the catch block of the program can be used to retrieve all the
<code class="language-plaintext highlighter-rouge">SQLException</code> objects one by one.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Connection</span> <span class="n">con</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

<span class="k">try</span> <span class="o">{</span>
    <span class="c1">// Open database connection</span>
    <span class="n">con</span> <span class="o">=</span> <span class="nc">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>

    <span class="c1">// Do something...</span>

    <span class="c1">// Close database connection</span>
    <span class="n">con</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
<span class="k">catch</span> <span class="o">(</span><span class="nc">SQLException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span>
        <span class="s">"SQLCODE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getErrorCode</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span>
        <span class="s">"SQLSTATE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getSQLState</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span>
        <span class="s">"PORUKA: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>

    <span class="c1">// We need to close the database connection,</span>
    <span class="c1">// even if error occures.</span>
    <span class="c1">// Since the close method can also throw SQLException,</span>
    <span class="c1">// we need to catch it,</span>
    <span class="c1">// but not deal with it.</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="kc">null</span> <span class="o">!=</span> <span class="n">con</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">con</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">SQLException</span> <span class="n">e2</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="o">}</span>
<span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

    <span class="c1">// Same as in above catch clause.</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="kc">null</span> <span class="o">!=</span> <span class="n">con</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">con</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">SQLException</span> <span class="n">e2</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="83-upravljanje-podacima">8.3 Upravljanje podacima</h2>

<p>After getting the connection, data can be selected, inserted, updated, or deleted from the
relational tables using SQL statements. JDBC driver implements two interfaces <code class="language-plaintext highlighter-rouge">Statement</code>
and <code class="language-plaintext highlighter-rouge">PreparedStatement</code> for this purpose. An object of any of these classes is required for
running an SQL statement.</p>

<h3 id="831-tipovi-podataka">8.3.1 Tipovi podataka</h3>

<p>To write efficient JDBC and SQLJ programs, you need to use the best mappings between
Java™ data types and table column data types.</p>

<p>Table 9.2 summarizes the mappings of Db2 or IBM Informix data types to Java data types
for ResultSet.getXXX methods in JDBC programs, and for iterators in SQLJ programs.
This table does not list Java numeric wrapper object types, which are retrieved using
ResultSet.getObject.</p>

<table>
  <thead>
    <tr>
      <th>SQL data type</th>
      <th>Recommended Java data type or Java object type</th>
      <th>Other supported Java data types</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>SMALLINT</td>
      <td>short</td>
      <td>byte, int, long, float, double, java.math.BigDecimal, boolean, java.lang.String</td>
    </tr>
    <tr>
      <td>INTEGER</td>
      <td>int</td>
      <td>short, byte, long, float, double, java.math.BigDecimal, boolean, java.lang.String</td>
    </tr>
    <tr>
      <td>BIGINT</td>
      <td>long</td>
      <td>int, short, byte, float, double, java.math.BigDecimal, boolean, java.lang.String</td>
    </tr>
    <tr>
      <td>DECIMAL(p,s) or NUMERIC(p,s)</td>
      <td>java.math.BigDecimal</td>
      <td>long, int, short, byte, float, double, boolean, java.lang.String</td>
    </tr>
    <tr>
      <td>DECFLOAT(n)</td>
      <td>java.math.BigDecimal</td>
      <td>long, int, short, byte, float, double, java.math.BigDecimal, boolean, java.lang.String</td>
    </tr>
    <tr>
      <td>REAL</td>
      <td>float</td>
      <td>long, int, short, byte, double, java.math.BigDecimal, boolean, java.lang.String</td>
    </tr>
    <tr>
      <td>DOUBLE</td>
      <td>double</td>
      <td>long, int, short, byte, float, java.math.BigDecimal, boolean, java.lang.String</td>
    </tr>
    <tr>
      <td>CHAR(n)</td>
      <td>java.lang.String</td>
      <td>long, int, short, byte, float, double, java.math.BigDecimal, boolean, java.sql.Date, java.sql.Time, java.sql.Timestamp, java.io.InputStream, java.io.Reader</td>
    </tr>
    <tr>
      <td>VARCHAR(n)</td>
      <td>java.lang.String</td>
      <td>long, int, short, byte, float, double, java.math.BigDecimal, boolean, java.sql.Date, java.sql.Time, java.sql.Timestamp, java.io.InputStream, java.io.Reader</td>
    </tr>
    <tr>
      <td>DATE</td>
      <td>java.sql.Date</td>
      <td>java.sql.String, java.sql.Timestamp</td>
    </tr>
    <tr>
      <td>TIME</td>
      <td>java.sql.Time</td>
      <td>java.sql.String, java.sql.Timestamp</td>
    </tr>
    <tr>
      <td>TIMESTAMP, TIMESTAMP(p), TIMESTAMP WITH TIME ZONE, TIMESTAMP(p) WITH TIME ZONE</td>
      <td>java.sql.Timestamp</td>
      <td>java.sql.String, java.sql.Date, java.sql.Time, java.sql.Timestamp</td>
    </tr>
  </tbody>
</table>

<p>Table 9.3 summarizes the mappings of Java data types to database data types for PreparedStatement.setXXX or ResultSet.updateXXX methods in JDBC programs, and for
input host expressions in SQLJ programs. When more than one Java data type is listed,
the first data type is the recommended data type.</p>

<table>
  <thead>
    <tr>
      <th>Java data type</th>
      <th>Database data type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>short, java.lang.Short</td>
      <td>SMALLINT</td>
    </tr>
    <tr>
      <td>boolean, byte, java.lang.Boolean, java.lang.Byte</td>
      <td>SMALLINT</td>
    </tr>
    <tr>
      <td>int, java.lang.Integer</td>
      <td>INTEGER</td>
    </tr>
    <tr>
      <td>long, java.lang.Long</td>
      <td>BIGINT</td>
    </tr>
    <tr>
      <td>java.math.BigInteger</td>
      <td>BIGINT</td>
    </tr>
    <tr>
      <td>java.math.BigInteger</td>
      <td>CHAR(n)</td>
    </tr>
    <tr>
      <td>float, java.lang.Float</td>
      <td>REAL</td>
    </tr>
    <tr>
      <td>double, java.lang.Double</td>
      <td>DOUBLE</td>
    </tr>
    <tr>
      <td>java.math.BigDecimal</td>
      <td>DECIMAL(p,s)</td>
    </tr>
    <tr>
      <td>java.math.BigDecimal</td>
      <td>DECFLOAT(n)</td>
    </tr>
    <tr>
      <td>java.lang.String</td>
      <td>CHAR(n)</td>
    </tr>
    <tr>
      <td>java.lang.String</td>
      <td>VARCHAR(n)</td>
    </tr>
    <tr>
      <td>java.sql.Date</td>
      <td>DATE</td>
    </tr>
    <tr>
      <td>java.sql.Time</td>
      <td>TIME</td>
    </tr>
    <tr>
      <td>java.sql.Timestamp</td>
      <td>TIMESTAMP, TIMESTAMP(p), TIMESTAMP WITH TIME ZONE, TIMESTAMP(p) WITH TIME ZONE</td>
    </tr>
    <tr>
      <td>java.util.Date</td>
      <td>CHAR(n)</td>
    </tr>
    <tr>
      <td>java.util.Date</td>
      <td>VARCHAR(n)</td>
    </tr>
    <tr>
      <td>java.util.Date</td>
      <td>DATE</td>
    </tr>
    <tr>
      <td>java.util.Date</td>
      <td>TIME</td>
    </tr>
    <tr>
      <td>java.util.Date</td>
      <td>TIMESTAMP, TIMESTAMP(p), TIMESTAMP WITH TIME ZONE, TIMESTAMP(p) WITH TIME ZONE</td>
    </tr>
  </tbody>
</table>

<h3 id="832-interfejs-statement">8.3.2 Interfejs Statement</h3>

<p>An object of <code class="language-plaintext highlighter-rouge">Statement</code> (or class implementing the <code class="language-plaintext highlighter-rouge">Statement</code> interface) can be used to
execute the SQL statement which does not contain parameter markers. An object can be
created from the <code class="language-plaintext highlighter-rouge">Connection</code> object using <code class="language-plaintext highlighter-rouge">createStatement</code> method.</p>

<p>Any number of statements can be created for a particular connection object.</p>

<p><code class="language-plaintext highlighter-rouge">Statement</code> interface defines <code class="language-plaintext highlighter-rouge">executeQuery</code> and <code class="language-plaintext highlighter-rouge">executeUpdate</code> methods to execute a query
statement. The <code class="language-plaintext highlighter-rouge">executeQuery</code> method is used when the result set is expected (for example, for the <code class="language-plaintext highlighter-rouge">SELECT</code> statement) as output of the query. Alternatively, <code class="language-plaintext highlighter-rouge">executeUpdate</code>
method is used for updating the database contents (for example, <code class="language-plaintext highlighter-rouge">INSERT</code>, <code class="language-plaintext highlighter-rouge">UPDATE</code>, and
<code class="language-plaintext highlighter-rouge">DELETE</code> statements). The <code class="language-plaintext highlighter-rouge">executeQuery</code> method returns the <code class="language-plaintext highlighter-rouge">ResultSet</code> object, which represents a set of rows returned by the <code class="language-plaintext highlighter-rouge">SELECT</code> query. This <code class="language-plaintext highlighter-rouge">ResultSet</code> object can be used
to fetch the result row by row. Method <code class="language-plaintext highlighter-rouge">executeUpdate</code> returns an integer value, which
indicates the number of rows updated, inserted, or deleted from the database based on
the type of SQL statement.</p>

<p>The following example illustrates the retrieval of data using the <code class="language-plaintext highlighter-rouge">Statement.executeQuery</code>
method. This method returns a result table in a <code class="language-plaintext highlighter-rouge">ResultSet object</code>. After you obtain the
result table, you need to use <code class="language-plaintext highlighter-rouge">ResultSet</code> methods to move through the result table and
obtain the individual column values from each row.</p>

<p>Da bismo iterirali kroz rezultujuću tabelu naredbe <code class="language-plaintext highlighter-rouge">SELECT</code> koja ne sadrži parametarske oznake, potrebno je da ispratimo naredne korake:</p>

<ol>
  <li>Kreirati objekat interfejsa <code class="language-plaintext highlighter-rouge">Statement</code> pozivom metoda
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">createStatement</span><span class="o">(...);</span>
</code></pre></div>    </div>
  </li>
  <li>Kreirati objekat interfejsa <code class="language-plaintext highlighter-rouge">ResultSet</code> pozivom metoda
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">ResultSet</span> <span class="n">kursor</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
  <li>Pozicionirati se na red koji je potrebno pročitati metodima za prolazak kroz kursor. Na primer:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">while</span> <span class="o">(</span><span class="n">kursor</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
 <span class="c1">// ...</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>Pozvati odgovarajući metod nad objektom <code class="language-plaintext highlighter-rouge">kursor</code> iz familije metoda <code class="language-plaintext highlighter-rouge">ResultSet.getXXX(int columnIndex)</code> za dohvatanje vrednosti iz kolone rezultujuće tabele sa indeksom <code class="language-plaintext highlighter-rouge">columnIndex</code></li>
  <li>Eventualno proveriti da li je dohvaćena <code class="language-plaintext highlighter-rouge">NULL</code> vrednost pozivom <code class="language-plaintext highlighter-rouge">kursor.wasNull()</code></li>
  <li>Nakon svih iteracija, pozvati metod <code class="language-plaintext highlighter-rouge">kursor.close()</code> radi zatvaranja kursora</li>
  <li>Nakon zatvaranja kursora, pozvati metod <code class="language-plaintext highlighter-rouge">stmt.close()</code> radi zatvaranja objekta naredbe</li>
</ol>

<div style="border: 2px solid rgb(196, 41, 255); padding: 5px; background-color: rgba(197, 197, 197, 0.3); margin: 10px 0;">
    <p style="font-weight: bold;">Zadatak 8.1</p>
    Napisati Java program u kojem se naredbe izvršavaju dinamički koji izlistava šifre i nazive svih predmeta koji imaju više od 20 ESPB bodova.
</div>

<p>Rešenje:</p>

<p>Datoteka: <code class="language-plaintext highlighter-rouge">primeri/poglavlje_8/src/zadatak_8_1/Main.java</code>:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">zadatak_8_1</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.sql.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
    <span class="c1">// Staticki blok koji sluzi za ucitavanje JDBC DB2 drajvera.</span>
    <span class="c1">// Izvrsava se kada se prvi put instancira objekat ove klase,</span>
    <span class="c1">// ili kada se prvi put pozove staticki metod.</span>
    <span class="kd">static</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"com.ibm.db2.jcc.DB2Driver"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span> <span class="n">argv</span><span class="o">[])</span> <span class="o">{</span>
        <span class="c1">// URL za JDBC konekciju tipa 4</span>
        <span class="nc">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"jdbc:db2://localhost:50001/vstud"</span><span class="o">;</span>

        <span class="c1">// Objekat koji ce sadrzati konekciju</span>
        <span class="c1">// Kreiramo konekciju na bazi podataka zadatoj u promenljivoj url,</span>
        <span class="c1">// koriscenjem metoda DriverManager.getConnection.</span>
        <span class="c1">// Argumenti za korisnicko ime i lozinku su obavezni!</span>
        <span class="c1">// try-with-resources vodi racuna o otvorenim resursima</span>
        <span class="c1">// i zatvara ih na kraju try-catch bloka</span>
        <span class="k">try</span> <span class="o">(</span><span class="nc">Connection</span> <span class="n">con</span> <span class="o">=</span> <span class="nc">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="s">"student"</span><span class="o">,</span> <span class="s">"abcdef"</span><span class="o">))</span> <span class="o">{</span>
            <span class="c1">// Kreiramo objekat naredbe (Statement)</span>
            <span class="nc">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>

            <span class="c1">// SQL upit ili naredbu koju zelimo da izvrsimo</span>
            <span class="c1">// zapisujemo kao nisku &lt;-&gt; DINAMICKI SQL</span>
            <span class="nc">String</span> <span class="n">queryStr</span> <span class="o">=</span> 
                <span class="s">"SELECT SIFRA, "</span> <span class="o">+</span> 
                <span class="s">"       NAZIV "</span> <span class="o">+</span> 
                <span class="s">"FROM   PREDMET "</span> <span class="o">+</span> 
                <span class="s">"WHERE  BODOVI &gt; 20"</span><span class="o">;</span>
            <span class="c1">// Za izvrsavanje upita koristimo Statement.executeQuery metod.</span>
            <span class="c1">// Ovaj metod vraca objekat klase ResultSet,</span>
            <span class="c1">// koji sadrzi rezultate upita (kursor).</span>
            <span class="nc">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">(</span><span class="n">queryStr</span><span class="o">);</span>

            <span class="c1">// Ispisujemo zaglavlje</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%-15s %-50S\n\n"</span><span class="o">,</span> <span class="s">"SIFRA"</span><span class="o">,</span> <span class="s">"NAZIV"</span><span class="o">);</span>

            <span class="c1">// Metodom ResultSet.next pozicioniramo kursor na naredni red.</span>
            <span class="c1">// Ako vise nema redova, metod ce vratiti vrednost false.</span>
            <span class="c1">// Inace, vratice true, pa mozemo da ga koristimo kao uslov u petlji</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
                <span class="c1">// Izdvajamo podatke koriscenjem familije metoda</span>
                <span class="c1">// ResultSet.getXXX,</span>
                <span class="c1">// gde je XXX neki tip podataka,</span>
                <span class="c1">// a argument je broj kolone koja se dohvata iz projekcije</span>
                <span class="c1">// upita.</span>
                <span class="nc">String</span> <span class="n">sifra</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
                <span class="nc">String</span> <span class="n">naziv</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>

                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%-15s %-50S\n"</span><span class="o">,</span> <span class="n">sifra</span><span class="o">.</span><span class="na">trim</span><span class="o">(),</span> <span class="n">naziv</span><span class="o">.</span><span class="na">trim</span><span class="o">());</span>
            <span class="o">}</span>

            <span class="c1">// Zatvaramo kursor</span>
            <span class="n">rs</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="c1">// Zatvaramo naredbu</span>
            <span class="n">stmt</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="c1">// Obrada SQL gresaka</span>
        <span class="k">catch</span> <span class="o">(</span><span class="nc">SQLException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// Ispisujemo sve informacije na standardni izlaz</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"SQLCODE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getErrorCode</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span> <span class="s">"SQLSTATE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getSQLState</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span>
                    <span class="o">+</span> <span class="s">"PORUKA: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>

            <span class="c1">// Signaliziramo neuspesan zavrsetak programa</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">// Obrada drugih gresaka</span>
        <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            
            <span class="c1">// Signaliziramo neuspesan zavrsetak programa</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">Statement.executeUpdate</code> is one of the JDBC methods that you can use to update
tables. You can use the <code class="language-plaintext highlighter-rouge">Statement.executeUpdate</code> method to do the following things:</p>

<ul>
  <li>Execute data definition statements, such as <code class="language-plaintext highlighter-rouge">CREATE</code>, <code class="language-plaintext highlighter-rouge">ALTER</code>, <code class="language-plaintext highlighter-rouge">DROP</code>, <code class="language-plaintext highlighter-rouge">GRANT</code>, <code class="language-plaintext highlighter-rouge">REVOKE</code>.</li>
  <li>Execute <code class="language-plaintext highlighter-rouge">INSERT</code>, <code class="language-plaintext highlighter-rouge">UPDATE</code>, <code class="language-plaintext highlighter-rouge">DELETE</code>, and <code class="language-plaintext highlighter-rouge">MERGE</code> statements that do not contain parameter markers.</li>
</ul>

<p>Da bismo izvršili ove SQL naredbe bez parametarskih oznaka, potrebno je da ispratimo naredne korake:</p>

<ol>
  <li>Kreirati objekat interfejsa <code class="language-plaintext highlighter-rouge">Statement</code> pozivom metoda
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
</code></pre></div>    </div>
  </li>
  <li>Pozvati metod <code class="language-plaintext highlighter-rouge">stmt.executeUpdate(String sql)</code></li>
  <li>Pozvati metod <code class="language-plaintext highlighter-rouge">stmt.close()</code> radi zatvaranja objekta naredbe</li>
</ol>

<p>Method <code class="language-plaintext highlighter-rouge">Statement.executeUpdate</code> returns an integer which represents the number of updated rows.</p>

<div style="border: 2px solid rgb(196, 41, 255); padding: 5px; background-color: rgba(197, 197, 197, 0.3); margin: 10px 0;">
    <p style="font-weight: bold;">Zadatak 8.2</p>
    Napisati Java program u kojem se naredbe izvršavaju dinamički koji u tabelu <span style="color: #e83e8c; background-color: #eef; padding: 1px 5px; font-family: SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;">PREDMET</span> unosi podatak o predmetu čiji je identifikator 2001, šifra Pred1, naziv Predmet 1, koji se sluša u prvom semestru i nosi <span style="color: #e83e8c; background-color: #eef; padding: 1px 5px; font-family: SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;">5</span> ESPB bodova.
</div>

<p>Rešenje:</p>

<p>Datoteka: <code class="language-plaintext highlighter-rouge">primeri/poglavlje_8/src/zadatak_8_2/Main.java</code>:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">zadatak_8_2</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.sql.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"com.ibm.db2.jcc.DB2Driver"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span> <span class="n">argv</span><span class="o">[])</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"jdbc:db2://localhost:50001/vstud"</span><span class="o">;</span>

        <span class="k">try</span> <span class="o">(</span><span class="nc">Connection</span> <span class="n">con</span> <span class="o">=</span> <span class="nc">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="s">"student"</span><span class="o">,</span> <span class="s">"abcdef"</span><span class="o">))</span> <span class="o">{</span>
            <span class="c1">// Zelimo da izvrsimo INSERT naredbu</span>
            <span class="c1">// u kojoj su sve informacije poznate.</span>
            <span class="c1">// To znaci da mozemo koristiti kombinaciju</span>
            <span class="c1">// interfejsa Statement i metoda executeUpdate().</span>
            <span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span> 
                <span class="s">"INSERT INTO PREDMET "</span> <span class="o">+</span>
                <span class="s">"VALUES (20001, 'Pred1', 'Predmet 1', 1, 6)"</span><span class="o">;</span>

            <span class="nc">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Unosim podatke u tabelu PREDMET..."</span><span class="o">);</span>

            <span class="c1">// Metod executeUpdate() se koristi ne samo za azuriranje,</span>
            <span class="c1">// vec i za unos, brisanje, i slicne naredbe.</span>
            <span class="kt">int</span> <span class="n">insertCount</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Broj unetih redova: "</span> <span class="o">+</span> <span class="n">insertCount</span><span class="o">);</span>

            <span class="n">stmt</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">SQLException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"SQLCODE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getErrorCode</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span> <span class="s">"SQLSTATE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getSQLState</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span>
                    <span class="o">+</span> <span class="s">"PORUKA: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="833-interfejs-preparedstatement">8.3.3 Interfejs <code class="language-plaintext highlighter-rouge">PreparedStatement</code></h3>

<p>An object of <code class="language-plaintext highlighter-rouge">PreparedStatement</code> (or a class implementing the <code class="language-plaintext highlighter-rouge">PreparedStatement</code> interface)
can be used to run the queries, which can contain parameter markers. A <code class="language-plaintext highlighter-rouge">PreparedStatement</code> object can be created using the <code class="language-plaintext highlighter-rouge">prepareStatement</code> method of <code class="language-plaintext highlighter-rouge">Connection</code> object.
<code class="language-plaintext highlighter-rouge">PreparedStatement</code> extends the <code class="language-plaintext highlighter-rouge">Statement</code> interface.</p>

<p>If the SQL statement contains parameter markers, the values for these parameter markers
need to be set before executing the statement. Value can be set using <code class="language-plaintext highlighter-rouge">setXXX</code> methods
of <code class="language-plaintext highlighter-rouge">PreparedStatement</code> object where <code class="language-plaintext highlighter-rouge">XXX</code> denoted the data type of the parameter marker.
<code class="language-plaintext highlighter-rouge">setXXX</code> methods are also called setter methods.</p>

<p>The following are the examples of setXXX methods:</p>

<ul>
  <li>setInt,</li>
  <li>setString,</li>
  <li>setDouble,</li>
  <li>setBytes,</li>
  <li>setClob,</li>
  <li>setBlob</li>
  <li>…</li>
</ul>

<p>After setting the parameter values, the SQL statement can be executed using any of the
<code class="language-plaintext highlighter-rouge">executeQuery</code>, <code class="language-plaintext highlighter-rouge">executeUpdate</code>, or <code class="language-plaintext highlighter-rouge">execute</code> method based on the SQL type.</p>

<div style="border: 2px solid rgb(196, 41, 255); padding: 5px; background-color: rgba(197, 197, 197, 0.3); margin: 10px 0;">
    <p style="font-weight: bold;">Zadatak 8.3</p>
    Napisati Java program u kojem se naredbe izvršavaju dinamički koji svim predmetima koji imaju X ESPB bodova, postavlja broj bodova na Y. Nakon toga ispisati broj ažuriranih redova. Brojevi X i Y se učitavaju sa standardnog ulaza.
</div>

<p>Rešenje:</p>

<p>Datoteka: <code class="language-plaintext highlighter-rouge">primeri/poglavlje_8/src/zadatak_8_3/Main.java</code>:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">zadatak_8_3</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.sql.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"com.ibm.db2.jcc.DB2Driver"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span> <span class="n">argv</span><span class="o">[])</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"jdbc:db2://localhost:50001/vstud"</span><span class="o">;</span>

        <span class="k">try</span> <span class="o">(</span>
        		<span class="nc">Connection</span> <span class="n">con</span> <span class="o">=</span> <span class="nc">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="s">"student"</span><span class="o">,</span> <span class="s">"abcdef"</span><span class="o">);</span>
        		<span class="nc">Scanner</span> <span class="n">ulaz</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Scanner</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
    		<span class="o">)</span> <span class="o">{</span>
            <span class="c1">// JDBC koristi iskljucivo dinamicke SQL naredbe,</span>
            <span class="c1">// tako da se u JDBC ne koriste maticne promenljive.</span>
            <span class="c1">// S obzirom da su vrednosti za bodove u klauzama SET i WHERE</span>
            <span class="c1">// nepoznate do faze izvrsavanja,</span>
            <span class="c1">// potrebno je da koristimo parametarske oznake na tim mestima.</span>
            <span class="nc">String</span> <span class="n">updateStr</span> <span class="o">=</span> 
                <span class="s">"UPDATE PREDMET "</span> <span class="o">+</span> 
                <span class="s">"SET    BODOVI = ? "</span> <span class="o">+</span> 
                <span class="s">"WHERE  BODOVI = ?"</span><span class="o">;</span>
            <span class="c1">// Zbog toga moramo da koristimo interfejs PreparedStatement,</span>
            <span class="c1">// jer interfejs Statement ne radi sa parametarskim oznakama.</span>
            <span class="nc">PreparedStatement</span> <span class="n">pUpd</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">updateStr</span><span class="o">);</span>

            <span class="c1">// Postavljamo odgovarajuce vrednosti za parametarske oznake</span>
            <span class="c1">// na osnovu procitanih vrednosti sa standardnog ulaza.</span>
            <span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">;</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">ulaz</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">ulaz</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
            
            <span class="c1">// Prvu parametarsku oznaku menjamo celim brojem y.</span>
            <span class="n">pUpd</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">y</span><span class="o">);</span>

            <span class="c1">// Drugu parametarsku oznaku menjamo celim brojem x.</span>
            <span class="n">pUpd</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">x</span><span class="o">);</span>

            <span class="c1">// Izvrsavamo naredbu metodom executeUpdate() </span>
            <span class="c1">// koji vraca broj azuriranih redova.</span>
            <span class="kt">int</span> <span class="n">numRows</span> <span class="o">=</span> <span class="n">pUpd</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Broj azuriranih redova: "</span> <span class="o">+</span> <span class="n">numRows</span><span class="o">);</span>

            <span class="n">pUpd</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">SQLException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"SQLCODE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getErrorCode</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span> <span class="s">"SQLSTATE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getSQLState</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span>
                    <span class="o">+</span> <span class="s">"PORUKA: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<div style="border: 2px solid rgb(196, 41, 255); padding: 5px; background-color: rgba(197, 197, 197, 0.3); margin: 10px 0;">
    <p style="font-weight: bold;">Zadatak 8.4</p>
    Napisati Java program u kojem se naredbe izvršavaju dinamički koji izdvaja indeks, ime,
prezime i naziv smera svih studenata koji su položili tačno N predmeta, kao i spisak tih
predmeta (naziv i ocena). Broj N se učitava sa standardnog ulaza.
</div>

<p>Rešenje: S obzirom da je SQL upit koji se koristi u ovom zadatku nešto složeniji, da ga ne bismo zapisivali u Java kodu kao nisku, taj upit ćemo začuvati u datoteci <code class="language-plaintext highlighter-rouge">upit.sql</code> u istom direktorijumu (paketu) kao i <code class="language-plaintext highlighter-rouge">Main.java</code> datoteku koja sadrži rešenje ovog zadatka. Dodatno, u Java kodu ćemo pronaći ovu datoteku na sistemu datoteka i učitati njen sadržaj kao nisku da bismo je zatim izvršili. Posebno treba obratiti pažnju na parametarsku oznaku u samom upitu, koja će biti zamenjena odgovarajućom vrednošću u fazi izvršavanja programa.</p>

<p>Datoteka: <code class="language-plaintext highlighter-rouge">primeri/poglavlje_8/src/zadatak_8_4/upit.sql</code>:</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">WITH</span> <span class="n">BROJ_POLOZENIH_ISPITA</span> <span class="k">AS</span> <span class="p">(</span>
    <span class="k">SELECT</span>      <span class="n">INDEKS</span>
    <span class="k">FROM</span>        <span class="n">ISPIT</span> 
    <span class="k">WHERE</span>       <span class="n">OCENA</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="k">AND</span> 
                <span class="n">STATUS_PRIJAVE</span> <span class="o">=</span> <span class="s1">'o'</span>
    <span class="k">GROUP</span> <span class="k">BY</span>    <span class="n">INDEKS</span>
    <span class="k">HAVING</span>      <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">=</span> <span class="o">?</span>
<span class="p">)</span>
<span class="k">SELECT</span>      <span class="n">D</span><span class="p">.</span><span class="n">INDEKS</span><span class="p">,</span> 
            <span class="n">IME</span><span class="p">,</span> 
            <span class="n">PREZIME</span><span class="p">,</span> 
            <span class="n">S</span><span class="p">.</span><span class="n">NAZIV</span><span class="p">,</span> 
            <span class="n">P</span><span class="p">.</span><span class="n">NAZIV</span><span class="p">,</span> 
            <span class="n">I</span><span class="p">.</span><span class="n">OCENA</span>
<span class="k">FROM</span>        <span class="n">DOSIJE</span> <span class="n">D</span> <span class="k">JOIN</span> 
            <span class="n">BROJ_POLOZENIH_ISPITA</span> <span class="n">BPI</span> <span class="k">ON</span> <span class="n">D</span><span class="p">.</span><span class="n">INDEKS</span> <span class="o">=</span> <span class="n">BPI</span><span class="p">.</span><span class="n">INDEKS</span> <span class="k">JOIN</span>
            <span class="n">SMER</span> <span class="n">S</span> <span class="k">ON</span> <span class="n">D</span><span class="p">.</span><span class="n">ID_SMERA</span> <span class="o">=</span> <span class="n">S</span><span class="p">.</span><span class="n">ID_SMERA</span> <span class="k">JOIN</span>
            <span class="n">ISPIT</span> <span class="n">I</span> <span class="k">ON</span> <span class="n">D</span><span class="p">.</span><span class="n">INDEKS</span> <span class="o">=</span> <span class="n">I</span><span class="p">.</span><span class="n">INDEKS</span> <span class="k">JOIN</span>
            <span class="n">PREDMET</span> <span class="n">P</span> <span class="k">ON</span> <span class="n">I</span><span class="p">.</span><span class="n">ID_PREDMETA</span> <span class="o">=</span> <span class="n">P</span><span class="p">.</span><span class="n">ID_PREDMETA</span>
<span class="k">WHERE</span>       <span class="n">I</span><span class="p">.</span><span class="n">OCENA</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="k">AND</span>
            <span class="n">I</span><span class="p">.</span><span class="n">STATUS_PRIJAVE</span> <span class="o">=</span> <span class="s1">'o'</span>
<span class="k">ORDER</span> <span class="k">BY</span>    <span class="n">D</span><span class="p">.</span><span class="n">INDEKS</span><span class="p">,</span>
            <span class="n">IME</span><span class="p">,</span>
            <span class="n">PREZIME</span><span class="p">,</span>
            <span class="n">S</span><span class="p">.</span><span class="n">NAZIV</span><span class="p">,</span>
            <span class="n">P</span><span class="p">.</span><span class="n">NAZIV</span>
</code></pre></div></div>

<p>Datoteka: <code class="language-plaintext highlighter-rouge">primeri/poglavlje_8/src/zadatak_8_4/Main.java</code>:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">zadatak_8_4</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileNotFoundException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"com.ibm.db2.jcc.DB2Driver"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span> <span class="n">argv</span><span class="o">[])</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"jdbc:db2://localhost:50001/vstud"</span><span class="o">;</span>

        <span class="k">try</span> <span class="o">(</span><span class="nc">Connection</span> <span class="n">con</span> <span class="o">=</span> <span class="nc">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="s">"student"</span><span class="o">,</span> <span class="s">"abcdef"</span><span class="o">))</span> <span class="o">{</span>
        	
            <span class="n">ispitiStudenteIIspite</span><span class="o">(</span><span class="n">con</span><span class="o">);</span>
            
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">SQLException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"SQLCODE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getErrorCode</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span> <span class="s">"SQLSTATE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getSQLState</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span>
                    <span class="o">+</span> <span class="s">"PORUKA: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">ispitiStudenteIIspite</span><span class="o">(</span><span class="nc">Connection</span> <span class="n">con</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">FileNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="n">ucitajSqlIzDatoteke</span><span class="o">();</span>
        <span class="kt">int</span> <span class="n">brojPredmeta</span> <span class="o">=</span> <span class="n">ucitajBrojPredmeta</span><span class="o">();</span>

        <span class="nc">PreparedStatement</span> <span class="n">pstmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sql</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="n">pstmt</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">brojPredmeta</span><span class="o">);</span>

        <span class="nc">ResultSet</span> <span class="n">result</span> <span class="o">=</span> <span class="n">pstmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">();</span>
        <span class="kt">int</span> <span class="n">brojRedova</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

        <span class="kt">int</span> <span class="n">indeks</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        
        <span class="k">while</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
            <span class="c1">// Ispisujemo informacije o studentu</span>
            <span class="c1">// samo kad naidjemo na novog studenta</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">indeks</span> <span class="o">!=</span> <span class="n">result</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="mi">1</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">indeks</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"\n\n\n"</span><span class="o">);</span>
                <span class="o">}</span>

                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Indeks: "</span> <span class="o">+</span> <span class="n">result</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span> <span class="s">"Ime: "</span> <span class="o">+</span> <span class="n">result</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="na">trim</span><span class="o">()</span>
                        <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span> <span class="s">"Prezime: "</span> <span class="o">+</span> <span class="n">result</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">3</span><span class="o">).</span><span class="na">trim</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span> <span class="s">"Smer: "</span>
                        <span class="o">+</span> <span class="n">result</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">4</span><span class="o">).</span><span class="na">trim</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span><span class="o">);</span>

                <span class="n">brojRedova</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="c1">// Ispisujemo informacije o i-tom predmetu</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">brojRedova</span> <span class="o">+</span> <span class="s">". predmet: "</span> <span class="o">+</span> <span class="n">result</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">5</span><span class="o">).</span><span class="na">trim</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n\t"</span> <span class="o">+</span> <span class="s">"ocena: "</span>
                    <span class="o">+</span> <span class="n">result</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="mi">6</span><span class="o">));</span>

            <span class="c1">// Uvecavamo broj reda</span>
            <span class="o">++</span><span class="n">brojRedova</span><span class="o">;</span>
            <span class="c1">// Pamtimo tekuci indeks za narednu iteraciju</span>
            <span class="n">indeks</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="n">pstmt</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">ucitajBrojPredmeta</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">brojPredmeta</span><span class="o">;</span>
        
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Unesite broj predmeta:"</span><span class="o">);</span>
        <span class="k">try</span> <span class="o">(</span><span class="nc">Scanner</span> <span class="n">ulaz</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Scanner</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">brojPredmeta</span> <span class="o">=</span> <span class="n">ulaz</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">brojPredmeta</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">ucitajSqlIzDatoteke</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">FileNotFoundException</span> <span class="o">{</span>
        <span class="c1">// Eclipse aplikacije se pokrecu iz direktorijuma projekta,</span>
        <span class="c1">// dakle, u podrazumevanom slucaju,</span>
        <span class="c1">// ~/IBM/rationalsdp/workspace/poglavlje_8/.</span>
        <span class="c1">// Mozemo koristiti sistemsko svojstvo</span>
        <span class="c1">// System.getProperty("user.dir")</span>
        <span class="c1">// da dohvatimo putanju u kojoj se pokrece aplikacija.</span>
        <span class="c1">// Takodje, prilikom kompiliranja .java datoteka u .class datoteke,</span>
        <span class="c1">// Eclipse alat ce kopirati sve druge datoteke iz src/ direktorijuma u bin/ direktorijum.</span>
        <span class="nc">String</span> <span class="n">putanja</span> <span class="o">=</span> <span class="s">"./bin/zadatak_8_4/upit.sql"</span><span class="o">;</span>
        <span class="nc">StringBuilder</span> <span class="n">sql</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">linija</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        
        <span class="k">try</span> <span class="o">(</span><span class="nc">Scanner</span> <span class="n">skenerFajla</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Scanner</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">putanja</span><span class="o">),</span> <span class="s">"utf-8"</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">skenerFajla</span><span class="o">.</span><span class="na">hasNextLine</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">linija</span> <span class="o">=</span> <span class="n">skenerFajla</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>
                <span class="n">sql</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">linija</span><span class="o">);</span>
                <span class="n">sql</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"\n"</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">sql</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="834-rukovanje-nedostajućim-vrednostima">8.3.4 Rukovanje nedostajućim vrednostima</h3>

<p>Što se tiče rada sa podacima koji su potencijalno nedostajući, na raspolaganju nam
je metod <code class="language-plaintext highlighter-rouge">ResultSet.wasNull</code>, koji je potrebno pozvati odmah nakon pozivanja metoda dohvatača za neku kolonu. Ukoliko je vrednost za tu kolonu bila <code class="language-plaintext highlighter-rouge">NULL</code>, onda će metod
<code class="language-plaintext highlighter-rouge">wasNull</code> vratiti vrednost <code class="language-plaintext highlighter-rouge">true</code>, a inače će vratiti <code class="language-plaintext highlighter-rouge">false</code>. Napomenimo da se poziv <code class="language-plaintext highlighter-rouge">wasNull</code>
metoda vezuje samo za poslednji poziv metoda <code class="language-plaintext highlighter-rouge">getXXX</code>, te samim tim i na poslednju dohvaćenu kolonu. Zbog toga je potrebno više puta pozivati ovaj metod ukoliko ima više
potencijalno nedostajućih kolona:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">ResultSet</span> <span class="n">res</span> <span class="o">=</span> <span class="o">...</span>

<span class="k">while</span> <span class="o">(</span><span class="n">res</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
    <span class="c1">// Vrednosti u ovoj koloni ne mogu biti NULL,</span>
    <span class="c1">// pa nemamo ni proveru za nju.</span>
    <span class="kt">int</span> <span class="n">kolona1_notnull</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>

    <span class="c1">// Vrednosti u ovoj koloni mogu biti NULL,</span>
    <span class="c1">// pa zato odmah nakon dohvatanja vrednosti,</span>
    <span class="c1">// pozivamo metod wasNull() da proverimo da li je NULL.</span>
    <span class="kt">int</span> <span class="n">kolona2_nullable</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
    <span class="kt">boolean</span> <span class="n">kol2IsNull</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="na">wasNull</span><span class="o">();</span>

    <span class="c1">// Vrednosti u ovoj koloni mogu biti NULL,</span>
    <span class="c1">// pa zato odmah nakon dohvatanja vrednosti,</span>
    <span class="c1">// pozivamo metod wasNull() da proverimo da li je NULL.</span>
    <span class="c1">// Ovaj poziv metoda wasNull() se odnosi na kolonu 3, a ne na 2.</span>
    <span class="nc">Date</span> <span class="n">kolona3_nullable</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="na">getDate</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
    <span class="kt">boolean</span> <span class="n">kol3IsNull</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="na">wasNull</span><span class="o">();</span>
    
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<div style="border: 2px solid rgb(196, 41, 255); padding: 5px; background-color: rgba(197, 197, 197, 0.3); margin: 10px 0;">
    <p style="font-weight: bold;">Zadatak 8.5</p>
    Napisati Java program u kojem se naredbe izvršavaju dinamički koji izdvaja ime, prezime i datum rođenja za sve studentkinje (pol = 'z') iz tabele <span style="color: #e83e8c; background-color: #eef; padding: 1px 5px; font-family: SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;">DOSIJE</span>. Ukoliko datum rođenja nije poznat, ispisati <span style="color: #e83e8c; background-color: #eef; padding: 1px 5px; font-family: SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;">Nepoznat</span>.
</div>

<p>Rešenje:</p>

<p>Datoteka: <code class="language-plaintext highlighter-rouge">primeri/poglavlje_8/src/zadatak_8_5/Main.java</code>:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">zadatak_8_5</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.sql.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"com.ibm.db2.jcc.DB2Driver"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span> <span class="n">argv</span><span class="o">[])</span> <span class="o">{</span>
    	<span class="nc">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"jdbc:db2://localhost:50001/vstud"</span><span class="o">;</span>

        <span class="k">try</span> <span class="o">(</span><span class="nc">Connection</span> <span class="n">con</span> <span class="o">=</span> <span class="nc">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="s">"student"</span><span class="o">,</span> <span class="s">"abcdef"</span><span class="o">))</span> <span class="o">{</span>
            
            <span class="nc">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
            <span class="nc">String</span> <span class="n">queryStr</span> <span class="o">=</span> 
                <span class="s">"SELECT IME, "</span> <span class="o">+</span> 
                <span class="s">"       PREZIME, "</span> <span class="o">+</span> 
                <span class="s">"       DATUM_RODJENJA "</span> <span class="o">+</span> 
                <span class="s">"FROM   DOSIJE "</span> <span class="o">+</span> 
                <span class="s">"WHERE  POL = 'z'"</span><span class="o">;</span>
            <span class="nc">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">(</span><span class="n">queryStr</span><span class="o">);</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%-25s %-25s %-15s \n\n"</span><span class="o">,</span> <span class="s">"IME"</span><span class="o">,</span> <span class="s">"PREZIME"</span><span class="o">,</span> <span class="s">"DATUM"</span><span class="o">);</span>

            <span class="k">while</span> <span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
                <span class="nc">String</span> <span class="n">ime</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">trim</span><span class="o">();</span>
                <span class="nc">String</span> <span class="n">prezime</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="na">trim</span><span class="o">();</span>
                <span class="nc">String</span> <span class="n">datum</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
                <span class="c1">// Ukoliko je u tekucem redu kursora datum bio NULL,</span>
                <span class="c1">// onda ce rs.wasNull() biti true</span>
                <span class="kt">boolean</span> <span class="n">datumIsNull</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="na">wasNull</span><span class="o">();</span>

                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%-25s %-25s %-15s \n"</span><span class="o">,</span> <span class="n">ime</span><span class="o">,</span> <span class="n">prezime</span><span class="o">,</span> <span class="o">(</span><span class="n">datumIsNull</span><span class="o">)</span> <span class="o">?</span> <span class="s">"NEPOZNAT"</span> <span class="o">:</span> <span class="n">datum</span><span class="o">.</span><span class="na">trim</span><span class="o">());</span>
            <span class="o">}</span>

            <span class="n">rs</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="n">stmt</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">SQLException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"SQLCODE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getErrorCode</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span> <span class="s">"SQLSTATE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getSQLState</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span>
                    <span class="o">+</span> <span class="s">"PORUKA: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="835-podešavanje-kursora">8.3.5 Podešavanje kursora</h3>

<p>A <code class="language-plaintext highlighter-rouge">ResultSet</code> maintains a cursor, which points to a row in the result set. It works like a
cursor in database programs. You can scroll the cursor to a specific row in the result set
to access or manipulate the column values for that row. The cursor can point to only one
row at a time. The row to which it points at a point in time is called the current row.
There are different ways to move the cursor of a <code class="language-plaintext highlighter-rouge">ResultSet</code> to a row in the result set.</p>

<p>The following three properties of a <code class="language-plaintext highlighter-rouge">ResultSet</code> need to be discussed before you can look at
an example:</p>

<ul>
  <li>Scrollability</li>
  <li>Concurrency</li>
  <li>Holdability</li>
</ul>

<p>Scrollability determines the ability of the <code class="language-plaintext highlighter-rouge">ResultSet</code> to scroll through the rows. By default,
a <code class="language-plaintext highlighter-rouge">ResultSet</code> is scrollable only in the forward direction. When you have a forward-only
scrollable <code class="language-plaintext highlighter-rouge">ResultSet</code>, you can move the cursor starting from the first row to the last row.
Once you move to the last row, you cannot reuse the ResultSet because you cannot scroll
back in a forward-only scrollable <code class="language-plaintext highlighter-rouge">ResultSet</code>. You can also create a <code class="language-plaintext highlighter-rouge">ResultSet</code> that can scroll
in the forward as well as the backward direction. We call this <code class="language-plaintext highlighter-rouge">ResultSet</code> a bidirectional
scrollable <code class="language-plaintext highlighter-rouge">ResultSet</code>.</p>

<p>A bidirectional scrollable <code class="language-plaintext highlighter-rouge">ResultSet</code> has another property called update sensitivity. It
determines whether the changes in the underlying database will be reflected in the result
set while you are scrolling through its rows. A scroll sensitive <code class="language-plaintext highlighter-rouge">ResultSet</code> shows you changes
made in the database, whereas a scroll insensitive one would not show you the changes
made in the database after you have opened the <code class="language-plaintext highlighter-rouge">ResultSet</code>. The following three constants
in the <code class="language-plaintext highlighter-rouge">ResultSet</code> interface are used to specify the scrollability of a <code class="language-plaintext highlighter-rouge">ResultSet</code>:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">TYPE_FORWARD_ONLY</code>: Allows a <code class="language-plaintext highlighter-rouge">ResultSet</code> to scroll only in the forward direction.</li>
  <li><code class="language-plaintext highlighter-rouge">TYPE_SCROLL_SENSITIVE</code>: Allows a <code class="language-plaintext highlighter-rouge">ResultSet</code> to scroll in the forward and backward
directions. It makes the changes in the underlying database made by other transactions or statements in the same transaction visible to the <code class="language-plaintext highlighter-rouge">ResultSet</code>. This type of
<code class="language-plaintext highlighter-rouge">ResultSet</code> is aware of the changes made to its data by other means.</li>
  <li><code class="language-plaintext highlighter-rouge">TYPE_SCROLL_INSENSITIVE</code>: Allows a <code class="language-plaintext highlighter-rouge">ResultSet</code> to scroll in the forward and backward
directions. It does not make the changes in the underlying database made by other
transactions or statements in the same transaction visible to the <code class="language-plaintext highlighter-rouge">ResultSet</code> while
scrolling. This type of <code class="language-plaintext highlighter-rouge">ResultSet</code> determines its data set when it is open and the
data set does not change if it is updated through any other means except through
this <code class="language-plaintext highlighter-rouge">ResultSet</code> itself. If you want to get up-to-date data, you must re-execute the
query.</li>
</ul>

<p>Concurrency refers to the ability of a <code class="language-plaintext highlighter-rouge">ResultSet</code> to update data. By default, a <code class="language-plaintext highlighter-rouge">ResultSet</code> is
read-only and it does not let you update its data. If you want to update data in a database
through a <code class="language-plaintext highlighter-rouge">ResultSet</code>, you need to request an updatable result set from the JDBC driver.
The following two constants in the <code class="language-plaintext highlighter-rouge">ResultSet</code> interface are used to specify the concurrency
of a <code class="language-plaintext highlighter-rouge">ResultSet</code>:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">CONCUR_READ_ONLY</code>: Makes a result set read-only.</li>
  <li><code class="language-plaintext highlighter-rouge">CONCUR_UPDATABLE</code>: Makes a result set updatable.</li>
</ul>

<p>Holdability refers to the state of a <code class="language-plaintext highlighter-rouge">ResultSet</code> after a transaction that it is associated with
has been committed. A <code class="language-plaintext highlighter-rouge">ResultSet</code> may be closed or kept open when the transaction is
committed. The default value of the holdability of a <code class="language-plaintext highlighter-rouge">ResultSet</code> is dependent on the JDBC
driver. For DB2 driver, the holdability is set to <code class="language-plaintext highlighter-rouge">false</code>. It is specified using one of the
following two constants defined in the <code class="language-plaintext highlighter-rouge">ResultSet</code> interface:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">HOLD_CURSORS_OVER_COMMIT</code>: Keeps the <code class="language-plaintext highlighter-rouge">ResultSet</code> open after the transaction is committed.</li>
  <li><code class="language-plaintext highlighter-rouge">CLOSE_CURSORS_AT_COMMIT</code>: Closes the <code class="language-plaintext highlighter-rouge">ResultSet</code> after the transaction is committed.</li>
</ul>

<p>Da bismo definisali ponašanje <code class="language-plaintext highlighter-rouge">ResultSet</code> objekta, potrebno je da prosledimo odgovarajuće
opcije metodima <code class="language-plaintext highlighter-rouge">createStatement</code>, odnosno, <code class="language-plaintext highlighter-rouge">prepareStatement</code>, koji su definisani nad
objektom interfejsa <code class="language-plaintext highlighter-rouge">Connection</code>, u zavisnosti od toga da li želimo da naredbu izvršimo kroz
interfejse <code class="language-plaintext highlighter-rouge">Statement</code> ili <code class="language-plaintext highlighter-rouge">PreparedStatement</code>, redom.</p>

<p>U slučaju kreiranja objekta <code class="language-plaintext highlighter-rouge">Statement</code>, na raspolaganju su nam naredna dva preopterećenja metoda <code class="language-plaintext highlighter-rouge">createStatement</code>:</p>

<ul>
  <li>Metod sa dva argumenta:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">int resultSetType</code> — Tip skupa rezultata.</li>
      <li><code class="language-plaintext highlighter-rouge">int resultSetConcurrency</code> — Tip konkurentnosti.</li>
    </ul>
  </li>
  <li>Metod sa tri argumenta:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">int resultSetType</code></li>
      <li><code class="language-plaintext highlighter-rouge">int resultSetConcurrency</code></li>
      <li><code class="language-plaintext highlighter-rouge">int resultSetHoldability</code> — Tip zadrživosti kursora prilikom izvršavanja operacije pohranjivanja.</li>
    </ul>
  </li>
</ul>

<p>U slučaju kreiranja objekta <code class="language-plaintext highlighter-rouge">PreparedStatement</code>, na raspolaganju su nam naredna dva
preopterećenja metoda <code class="language-plaintext highlighter-rouge">prepareStatement</code>, sa istim značenjima parametara kao i u slučaju
metoda <code class="language-plaintext highlighter-rouge">createStatement</code>:</p>

<ul>
  <li>Metod sa tri argumenta:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">String sql</code> — Niska koja sadrži tekstualni oblik SQL naredbe. Može sadržati
nula ili više parametarskih oznaka.</li>
      <li><code class="language-plaintext highlighter-rouge">int resultSetType</code></li>
      <li><code class="language-plaintext highlighter-rouge">int resultSetConcurrency</code></li>
    </ul>
  </li>
  <li>Metod sa četiri argumenta:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">String sql</code></li>
      <li><code class="language-plaintext highlighter-rouge">int resultSetType</code></li>
      <li><code class="language-plaintext highlighter-rouge">int resultSetConcurrency</code></li>
      <li><code class="language-plaintext highlighter-rouge">int resultSetHoldability</code></li>
    </ul>
  </li>
</ul>

<div style="border: 2px solid rgb(196, 41, 255); padding: 5px; background-color: rgba(197, 197, 197, 0.3); margin: 10px 0;">
    <p style="font-weight: bold;">Zadatak 8.6</p>
    Napisati Java program u kojem se naredbe izvršavaju dinamički koji ispisuje podatke o ispitnim rokovima koristeći kursor kome je omogućeno kretanje i unazad kroz podatke. Podatke urediti po nazivu rastuće, ali ih ispisivati opadajuće.
</div>

<p>Rešenje:</p>

<p>Datoteka: <code class="language-plaintext highlighter-rouge">primeri/poglavlje_8/src/zadatak_8_6/Main.java</code>:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">zadatak_8_6</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.sql.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"com.ibm.db2.jcc.DB2Driver"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span> <span class="n">argv</span><span class="o">[])</span> <span class="o">{</span>
    	<span class="nc">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"jdbc:db2://localhost:50001/vstud"</span><span class="o">;</span>

        <span class="k">try</span> <span class="o">(</span><span class="nc">Connection</span> <span class="n">con</span> <span class="o">=</span> <span class="nc">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="s">"student"</span><span class="o">,</span> <span class="s">"abcdef"</span><span class="o">))</span> <span class="o">{</span>
            
            <span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span> 
                <span class="s">"SELECT     * "</span> <span class="o">+</span> 
                <span class="s">"FROM       ISPITNI_ROK "</span> <span class="o">+</span> 
                <span class="s">"ORDER BY   NAZIV"</span><span class="o">;</span>
            <span class="nc">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">createStatement</span><span class="o">(</span>
                <span class="c1">// Podesavamo da je kursor bidirekcioni i nesenzitivni,</span>
                <span class="c1">// sto znaci da moze da se krece kroz njega u oba smera,</span>
                <span class="c1">// i da izmene u bazi podataka nece biti vidljive tokom</span>
                <span class="c1">// prolazenja kroz kursora</span>
                <span class="nc">ResultSet</span><span class="o">.</span><span class="na">TYPE_SCROLL_INSENSITIVE</span><span class="o">,</span>
                <span class="c1">// Podesavamo da se kursor koristi samo za citanje</span>
                <span class="nc">ResultSet</span><span class="o">.</span><span class="na">CONCUR_READ_ONLY</span><span class="o">);</span>
            <span class="nc">ResultSet</span> <span class="n">res</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%-10s %-10s %-20s %-20s %-20s %-5s\n\n"</span><span class="o">,</span> 
                <span class="s">"GODINA"</span><span class="o">,</span> <span class="s">"OZNAKA"</span><span class="o">,</span> <span class="s">"NAZIV"</span><span class="o">,</span> <span class="s">"POCETAK PRIJAVE"</span><span class="o">,</span> <span class="s">"KRAJ PRIJAVE"</span><span class="o">,</span> <span class="s">"TIP"</span><span class="o">);</span>

            <span class="c1">// Pozicioniranje na kraj kursora</span>
            <span class="n">res</span><span class="o">.</span><span class="na">afterLast</span><span class="o">();</span>

            <span class="c1">// Citanje unazad</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">res</span><span class="o">.</span><span class="na">previous</span><span class="o">())</span> <span class="o">{</span>
                <span class="kt">int</span> <span class="n">godina</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
                <span class="nc">String</span> <span class="n">oznaka</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="na">trim</span><span class="o">();</span>
                <span class="nc">String</span> <span class="n">naziv</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">3</span><span class="o">).</span><span class="na">trim</span><span class="o">();</span>
                <span class="nc">Date</span> <span class="n">datum_pocetka</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="na">getDate</span><span class="o">(</span><span class="mi">4</span><span class="o">);</span>
                <span class="nc">Date</span> <span class="n">datum_kraja</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="na">getDate</span><span class="o">(</span><span class="mi">5</span><span class="o">);</span>
                <span class="nc">String</span> <span class="n">tip</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">6</span><span class="o">).</span><span class="na">trim</span><span class="o">();</span>

                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%-10d %-10s %-20s %-20s %-20s %-5s\n"</span><span class="o">,</span> 
                    <span class="n">godina</span><span class="o">,</span> <span class="n">oznaka</span><span class="o">,</span> <span class="n">naziv</span><span class="o">,</span> <span class="n">datum_pocetka</span><span class="o">.</span><span class="na">toString</span><span class="o">(),</span> <span class="n">datum_kraja</span><span class="o">.</span><span class="na">toString</span><span class="o">(),</span> <span class="n">tip</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="n">res</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="n">stmt</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">SQLException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"SQLCODE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getErrorCode</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span> <span class="s">"SQLSTATE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getSQLState</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span>
                    <span class="o">+</span> <span class="s">"PORUKA: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="836-ažuriranje-redova-korišćenjem-resultset-kursora">8.3.6 Ažuriranje redova korišćenjem ResultSet kursora</h3>

<p>Postoje dve procedure za ažuriranje informacija u bazi podataka na osnovu <code class="language-plaintext highlighter-rouge">ResultSet</code>
kursora:</p>

<ul>
  <li>Korišćenjem pozicionirajuće <code class="language-plaintext highlighter-rouge">UPDATE</code> naredbe.</li>
  <li>Korišćenjem JDBC metoda <code class="language-plaintext highlighter-rouge">updateXXX</code> i <code class="language-plaintext highlighter-rouge">updateRow</code>.</li>
</ul>

<p>Kao što znamo, možemo koristiti pozicionirajuću <code class="language-plaintext highlighter-rouge">UPDATE</code> naredbu za menjanje podataka
u bazi podataka, na osnovu tekućeg reda kursora, tako što se na kursor referiše u <code class="language-plaintext highlighter-rouge">WHERE CURRENT OF</code> 
klauzi naredbe. Da bismo dohvatili naziv <code class="language-plaintext highlighter-rouge">ResultSet</code> kursora, možemo iskoristiti
metod <code class="language-plaintext highlighter-rouge">ResultSet.getCursorName</code>, koji vraća nisku sa nazivom kursora koji je vezan
za taj <code class="language-plaintext highlighter-rouge">ResultSet</code>. Na primer, naredni fragment koda ilustruje kako možemo ažurirati broj bodova za sve predmete iz tabele <code class="language-plaintext highlighter-rouge">PREDMET</code> korišćenjem pozicionirajuće <code class="language-plaintext highlighter-rouge">UPDATE</code> naredbe:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">upit</span> <span class="o">=</span>
    <span class="s">"SELECT SIFRA, "</span> <span class="o">+</span>
    <span class="s">"       NAZIV, "</span> <span class="o">+</span> 
    <span class="s">"       BODOVI "</span> <span class="o">+</span>
    <span class="s">"FROM   PREDMET "</span> <span class="o">+</span>
    <span class="s">"FOR    UPDATE OF BODOVI"</span><span class="o">;</span>

<span class="nc">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
<span class="nc">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">(</span><span class="n">upit</span><span class="o">);</span>

<span class="nc">String</span> <span class="n">nazivKursora</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="na">getCursorName</span><span class="o">();</span>
<span class="nc">String</span> <span class="n">azuriranje</span> <span class="o">=</span>
    <span class="s">"UPDATE PREDMET "</span> <span class="o">+</span>
    <span class="s">"SET    BODOVI = ? "</span> <span class="o">+</span>
    <span class="s">"WHERE  CURRENT OF "</span> <span class="o">+</span> <span class="n">nazivKursora</span><span class="o">;</span>
<span class="nc">PreparedStatement</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">nazivKursora</span><span class="o">);</span>

<span class="k">try</span> <span class="o">(</span><span class="nc">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Scanner</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">))</span> <span class="o">{</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Unesite nove ESPB bodove za predmet "</span> <span class="o">+</span> <span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">2</span><span class="o">));</span>
        <span class="kt">int</span> <span class="n">newESPB</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>

        <span class="n">ps</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">newESPB</span><span class="o">);</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Drugi pristup podrazumeva korišćenje specifičnih metoda radi ažuriranja podataka u kursoru, čime se efektivno vrši ažuriranje u bazi podataka. Naredni koraci opisuju postupak ažuriranja postojećih slogova u <code class="language-plaintext highlighter-rouge">ResultSet</code>:</p>

<ol>
  <li>Kreirati objekat interfejsa <code class="language-plaintext highlighter-rouge">Statement</code> pozivom metoda
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">createStatement</span><span class="o">(...,</span> <span class="nc">ResultSet</span><span class="o">.</span><span class="na">CONCUR_UPDATABLE</span><span class="o">,</span> <span class="o">...);</span>
</code></pre></div>    </div>
  </li>
  <li>Kreirati objekat interfejsa <code class="language-plaintext highlighter-rouge">ResultSet</code> pozivom metoda
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">ResultSet</span> <span class="n">kursor</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
  <li>Pozicionirati se na slog koji je potrebno ažurirati metodima za prolazak kroz kursor. Na primer:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">while</span> <span class="o">(</span><span class="n">kursor</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
 <span class="c1">// ...</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>Pozvati odgovarajući metod nad objektom <code class="language-plaintext highlighter-rouge">kursor</code> iz familije metoda <code class="language-plaintext highlighter-rouge">ResultSet.updateXXX(int columnIndex, XXX x)</code> za ažuriranje vrednosti kolone tabele sa indeksom <code class="language-plaintext highlighter-rouge">columnIndex</code> novom vrednošću <code class="language-plaintext highlighter-rouge">x</code></li>
  <li>Ako želimo da poništimo izmene, možemo pozvati metod <code class="language-plaintext highlighter-rouge">kursor.cancelRowUpdates()</code></li>
  <li>Ukoliko želimo da zapravo izvršimo izmene nad slogom u BP, potrebno je da pozovemo metod <code class="language-plaintext highlighter-rouge">kursor.updateRow()</code>. U suprotnom će, prelaskom na drugi red, sve izmene biti ignorisane</li>
  <li>Nakon svih iteracija, pozvati metod <code class="language-plaintext highlighter-rouge">kursor.close()</code> radi zatvaranja kursora</li>
  <li>Nakon zatvaranja kursora, pozvati metod <code class="language-plaintext highlighter-rouge">stmt.close()</code> radi zatvaranja objekta naredbe</li>
</ol>

<div style="border: 2px solid rgb(196, 41, 255); padding: 5px; background-color: rgba(197, 197, 197, 0.3); margin: 10px 0;">
    <p style="font-weight: bold;">Zadatak 8.7</p>
    Napisati Java program u kojem se naredbe izvršavaju dinamički koji ispisuje sadržaj tabele
<span style="color: #e83e8c; background-color: #eef; padding: 1px 5px; font-family: SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;">PREDMET</span> i, u istoj iteraciji, ukoliko je broj bodova jednak X, postavlja se broj bodova na
Y i ispisuje se poruka da je promena izvršena, zajedno sa ispisom novih podataka o
tom predmetu. Brojevi X i Y se učitavaju sa standardnog ulaza.
</div>

<p>Rešenje:</p>

<p>Datoteka: <code class="language-plaintext highlighter-rouge">primeri/poglavlje_8/src/zadatak_8_7/Main.java</code>:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">zadatak_8_7</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.sql.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"com.ibm.db2.jcc.DB2Driver"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span> <span class="n">argv</span><span class="o">[])</span> <span class="o">{</span>
    	<span class="nc">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"jdbc:db2://localhost:50001/vstud"</span><span class="o">;</span>

        <span class="k">try</span> <span class="o">(</span><span class="nc">Connection</span> <span class="n">con</span> <span class="o">=</span> <span class="nc">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="s">"student"</span><span class="o">,</span> <span class="s">"abcdef"</span><span class="o">))</span> <span class="o">{</span>
            
            <span class="n">ispisi_i_azuriraj_predmete</span><span class="o">(</span><span class="n">con</span><span class="o">);</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">SQLException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"SQLCODE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getErrorCode</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span> <span class="s">"SQLSTATE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getSQLState</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span>
                    <span class="o">+</span> <span class="s">"PORUKA: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">ispisi_i_azuriraj_predmete</span><span class="o">(</span><span class="nc">Connection</span> <span class="n">con</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">SQLException</span> <span class="o">{</span>
        <span class="kt">int</span><span class="o">[]</span> <span class="n">ucitaniBodovi</span> <span class="o">=</span> <span class="n">ucitaj_stare_i_nove_bodove</span><span class="o">();</span>
        
        <span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span> 
            <span class="s">"SELECT * "</span> <span class="o">+</span> 
            <span class="s">"FROM   PREDMET"</span><span class="o">;</span>
        <span class="nc">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">createStatement</span><span class="o">(</span> 
                <span class="c1">// Dovoljan nam je kursor koji prolazi unapred kroz redove.</span>
                <span class="nc">ResultSet</span><span class="o">.</span><span class="na">TYPE_FORWARD_ONLY</span><span class="o">,</span>
                <span class="c1">// Definisemo da je kursor azurirajuci,</span>
                <span class="c1">// pa su nam dostupni metodi</span>
                <span class="c1">// ResultSet.updateXXX i ResultSet.updateRow</span>
                <span class="c1">// koje cemo koristiti za azuriranje tekuceg reda</span>
                <span class="nc">ResultSet</span><span class="o">.</span><span class="na">CONCUR_UPDATABLE</span><span class="o">);</span>
        <span class="nc">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>

        <span class="k">while</span> <span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Sifra: "</span> <span class="o">+</span> <span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="na">trim</span><span class="o">()</span> <span class="o">+</span> <span class="s">", "</span> <span class="o">+</span> <span class="s">"Naziv:"</span> <span class="o">+</span> <span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">3</span><span class="o">).</span><span class="na">trim</span><span class="o">()</span> <span class="o">+</span> <span class="s">", "</span>
                    <span class="o">+</span> <span class="s">"Bodovi: "</span> <span class="o">+</span> <span class="n">rs</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="mi">5</span><span class="o">));</span>

            <span class="k">if</span> <span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span> <span class="o">==</span> <span class="n">ucitaniBodovi</span><span class="o">[</span><span class="mi">0</span><span class="o">])</span> <span class="o">{</span>
                <span class="c1">// Azuriramo vrednost u koloni broj 5 (bodovi) iz upita iznad.</span>
                <span class="n">rs</span><span class="o">.</span><span class="na">updateInt</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="n">ucitaniBodovi</span><span class="o">[</span><span class="mi">1</span><span class="o">]);</span>
                <span class="c1">// Kada zavrsimo sa azuriranjem svih kolona,</span>
                <span class="c1">// pozivamo metod updateRow</span>
                <span class="c1">// da bi se sve promene odmah oslikale.</span>
                <span class="c1">// Ako zaboravimo da pozovemo ovaj metod,</span>
                <span class="c1">// izmene se nece propagirati i bice izgubljene.</span>
                <span class="n">rs</span><span class="o">.</span><span class="na">updateRow</span><span class="o">();</span>

                <span class="c1">// Sada kada zahtevamo vrednosti u kolonama,</span>
                <span class="c1">// dobicemo azurirane vrednosti:</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"------&gt; Izvrsena je naredna promena:"</span><span class="o">);</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"        Sifra: "</span> <span class="o">+</span> <span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="na">trim</span><span class="o">()</span> <span class="o">+</span> <span class="s">", "</span> <span class="o">+</span> <span class="s">"Naziv:"</span> <span class="o">+</span> <span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">3</span><span class="o">).</span><span class="na">trim</span><span class="o">()</span>
                        <span class="o">+</span> <span class="s">", "</span> <span class="o">+</span> <span class="s">"Bodovi: "</span>
                        <span class="o">+</span> <span class="n">rs</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span> <span class="cm">/* azurirana vrednost */</span> <span class="o">+</span> <span class="s">"\n"</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="n">rs</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span><span class="o">[]</span> <span class="nf">ucitaj_stare_i_nove_bodove</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">int</span><span class="o">[]</span> <span class="n">rezultat</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="mi">2</span><span class="o">];</span>
        
        <span class="k">try</span> <span class="o">(</span><span class="nc">Scanner</span> <span class="n">ulaz</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Scanner</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">))</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Unesite stare bodove:"</span><span class="o">);</span>
            <span class="n">rezultat</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="n">ulaz</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Unesite nove bodove:"</span><span class="o">);</span>
            <span class="n">rezultat</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">ulaz</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
        <span class="o">}</span>
        
        <span class="k">return</span> <span class="n">rezultat</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="837-unos-redova-korišćenjem-resultset-kursora">8.3.7 Unos redova korišćenjem ResultSet kursora</h3>

<p>Ono što nismo imali prilike da vidimo jeste da se pomoću kursora mogu uneti novi slogovi u tabelu. Za unos novog sloga u tabelu koristi se specijalni „slog za unos“. Ovaj specijalni slog zapravo predstavlja bafer za konstruisanje novog sloga koji će biti unet u odgovarajuću tabelu.</p>

<p>Konstrukcija novog sloga se vrši u dva koraka:</p>
<ol>
  <li>Potrebno je postaviti vrednosti svih kolona rezultujuće tabele u „slogu za unos“ pozivom odgovarajućih metoda iz familije metoda <code class="language-plaintext highlighter-rouge">ResultSet.updateXXX(int columnIndex, XXX x)</code></li>
  <li>Kada su svim kolonama u „slogu za unos“ dodeljene odgovarajuće vrednosti, tada je potrebno izvršiti unos baferisanog „sloga za unos“ u rezultujuću tabelu.</li>
</ol>

<p>Unos baferisanog „slogu za unos“ se izvršava pozivom metoda <code class="language-plaintext highlighter-rouge">void ResultSet.insertRow()</code>. Međutim, da bismo zapravo uspeli da konstruišemo ovaj specijalni slog, neophodno je da signaliziramo kursoru da želimo da menjamo baš taj red, a ne tekući red kroz koji se iterira u kursoru. Ovo je moguće uraditi pozivom metoda <code class="language-plaintext highlighter-rouge">void ResultSet.moveToInsertRow()</code>. Prilikom poziva ovog metoda, kursor se pozicionira na „slog za unos“ i ujedno se pamti redni broj tekućeg sloga koji se obrađuje u kursoru. Nakon što smo završili proceduru za unos opisanu prethodnim koracima, potrebno je pozvati metod <code class="language-plaintext highlighter-rouge">void ResultSet.moveToCurrentRow()</code> koji će ponovo pozicionirati kursor na prethodno zapamćeni tekući slog koji se obrađuje u kursoru.</p>

<p>Dakle, celokupna procedura za unos novog sloga je data narednim koracima:</p>

<ol>
  <li>Kreirati objekat interfejsa <code class="language-plaintext highlighter-rouge">Statement</code> pozivom metoda
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">createStatement</span><span class="o">(...,</span> <span class="nc">ResultSet</span><span class="o">.</span><span class="na">CONCUR_UPDATABLE</span><span class="o">,</span> <span class="o">...);</span>
</code></pre></div>    </div>
  </li>
  <li>Kreirati objekat interfejsa <code class="language-plaintext highlighter-rouge">ResultSet</code> pozivom metoda
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">ResultSet</span> <span class="n">kursor</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
  <li>Pozicionirati se na „slog za unos“ pozivom metoda <code class="language-plaintext highlighter-rouge">kursor.moveToInsertRow()</code></li>
  <li>Pozvati odgovarajući metod nad objektom <code class="language-plaintext highlighter-rouge">kursor</code> iz familije metoda <code class="language-plaintext highlighter-rouge">ResultSet.updateXXX(int columnIndex, XXX x)</code> za postavljanje vrednosti kolone „sloga za unos“ sa indeksom <code class="language-plaintext highlighter-rouge">columnIndex</code> novom vrednošću <code class="language-plaintext highlighter-rouge">x</code></li>
  <li>Ukoliko želimo da zapravo unesemo novi slog u BP, potrebno je da pozovemo metod <code class="language-plaintext highlighter-rouge">kursor.insertRow()</code>. U suprotnom će, prelaskom na drugi red, sve izmene biti ignorisane</li>
  <li>Pozicionirati se na tekući slog u rezultujućoj tabeli kursora pozivom metoda <code class="language-plaintext highlighter-rouge">kursor.moveToCurrentRow()</code></li>
  <li>Nakon svih iteracija, pozvati metod <code class="language-plaintext highlighter-rouge">kursor.close()</code> radi zatvaranja kursora</li>
  <li>Nakon zatvaranja kursora, pozvati metod <code class="language-plaintext highlighter-rouge">stmt.close()</code> radi zatvaranja objekta naredbe</li>
</ol>

<div style="border: 2px solid rgb(196, 41, 255); padding: 5px; background-color: rgba(197, 197, 197, 0.3); margin: 10px 0;">
    <p style="font-weight: bold;">Zadatak 8.8</p>
    Napisati Java program u kojem se naredbe izvršavaju dinamički koji:<br />
1. Kreira tabelu <span style="color: #e83e8c; background-color: #eef; padding: 1px 5px; font-family: SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;">UNETI_PREDMETI</span> čije su kolone: (1) identifikator predmeta i (2) broj položenih ispita za taj predmet. Postaviti odgovarajuće primarne i strane ključeve.<br />
2. Za svaki predmet koji nije prethodno obrađen (tj. koji se ne nalazi u tabeli <span style="color: #e83e8c; background-color: #eef; padding: 1px 5px; font-family: SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;">UNETI_PREDMETI</span>) pronalazi statistiku koja se sastoji od njegovog identifikator i broj položenih ispita.<br />
3. Za svaku pronađenu statistiku ispisuje podatke na standardni izlaz i pita korisnika da li želi da unete statistiku u tabelu <span style="color: #e83e8c; background-color: #eef; padding: 1px 5px; font-family: SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;">UNETI_PREDMETI</span>. Ukoliko korisnik potvrdi, potrebno je uneti statistiku u datu tabelu i ispisati poruku o uspehu. U suprotnom, ispisati poruku da je korisnik poništio unos.
</div>

<p>Rešenje:</p>

<p>Datoteka: <code class="language-plaintext highlighter-rouge">primeri/poglavlje_8/src/zadatak_8_8/Main.java</code>:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">zadatak_8_8</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.sql.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"com.ibm.db2.jcc.DB2Driver"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">StatistikaPolaganja</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">int</span> <span class="n">id_predmeta</span><span class="o">;</span>
        <span class="kd">public</span> <span class="kt">int</span> <span class="n">broj_polaganja</span><span class="o">;</span>
        
        <span class="kd">public</span> <span class="nf">StatistikaPolaganja</span><span class="o">(</span><span class="kt">int</span> <span class="n">id_predmeta</span><span class="o">,</span> <span class="kt">int</span> <span class="n">broj_polaganja</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">id_predmeta</span> <span class="o">=</span> <span class="n">id_predmeta</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">broj_polaganja</span> <span class="o">=</span> <span class="n">broj_polaganja</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span> <span class="n">argv</span><span class="o">[])</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"jdbc:db2://localhost:50001/vstud"</span><span class="o">;</span>
        <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">StatistikaPolaganja</span><span class="o">&gt;</span> <span class="n">statistike</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

        <span class="k">try</span> <span class="o">(</span><span class="nc">Connection</span> <span class="n">con</span> <span class="o">=</span> <span class="nc">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="s">"student"</span><span class="o">,</span> <span class="s">"abcdef"</span><span class="o">))</span> <span class="o">{</span>
            
            <span class="n">kreiraj_tabelu</span><span class="o">(</span><span class="n">con</span><span class="o">);</span>
            <span class="n">sakupi_statistiku</span><span class="o">(</span><span class="n">con</span><span class="o">,</span> <span class="n">statistike</span><span class="o">);</span>
            <span class="n">unesi_predmete_iz_statistike</span><span class="o">(</span><span class="n">con</span><span class="o">,</span> <span class="n">statistike</span><span class="o">);</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">SQLException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"SQLCODE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getErrorCode</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span> <span class="s">"SQLSTATE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getSQLState</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span>
                    <span class="o">+</span> <span class="s">"PORUKA: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">kreiraj_tabelu</span><span class="o">(</span><span class="nc">Connection</span> <span class="n">con</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">SQLException</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">"CREATE TABLE UNETI_PREDMETI ( "</span>
                <span class="o">+</span> <span class="s">"ID_PREDMETA INTEGER NOT NULL, "</span>
                <span class="o">+</span> <span class="s">"BROJ_POLOZENIH INTEGER NOT NULL, "</span>
                <span class="o">+</span> <span class="s">"PRIMARY KEY (ID_PREDMETA), "</span>
                <span class="o">+</span> <span class="s">"FOREIGN KEY (ID_PREDMETA) REFERENCES PREDMET "</span>
                <span class="o">+</span> <span class="s">")"</span><span class="o">;</span>
        <span class="nc">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">stmt</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">SQLException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// Ignorisemo gresku samo ako je u pitanju greska da tabela vec postoji (-601).</span>
            <span class="c1">// Sve ostale ispaljujemo main metodu.</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getErrorCode</span><span class="o">()</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">601</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">throw</span> <span class="n">e</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">sakupi_statistiku</span><span class="o">(</span><span class="nc">Connection</span> <span class="n">con</span><span class="o">,</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">StatistikaPolaganja</span><span class="o">&gt;</span> <span class="n">statistike</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">SQLException</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">"SELECT  ID_PREDMETA, COUNT(OCENA) "</span> <span class="o">+</span>
            <span class="s">"FROM    ISPIT "</span> <span class="o">+</span>
            <span class="s">"WHERE   OCENA &gt; 5 AND "</span> <span class="o">+</span>
            <span class="s">"        STATUS_PRIJAVE = 'o' AND "</span> <span class="o">+</span>
            <span class="s">"        ID_PREDMETA NOT IN (SELECT ID_PREDMETA FROM UNETI_PREDMETI) "</span> <span class="o">+</span>
            <span class="s">"GROUP BY ID_PREDMETA"</span><span class="o">;</span>
        <span class="nc">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
        <span class="nc">ResultSet</span> <span class="n">kursor</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">kursor</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">id_predmeta</span> <span class="o">=</span> <span class="n">kursor</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
            <span class="kt">int</span> <span class="n">broj_polaganja</span> <span class="o">=</span> <span class="n">kursor</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span> 
            <span class="n">statistike</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">StatistikaPolaganja</span><span class="o">(</span><span class="n">id_predmeta</span><span class="o">,</span> <span class="n">broj_polaganja</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="n">kursor</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">unesi_predmete_iz_statistike</span><span class="o">(</span><span class="nc">Connection</span> <span class="n">con</span><span class="o">,</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">StatistikaPolaganja</span><span class="o">&gt;</span> <span class="n">statistike</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">SQLException</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span> 
            <span class="s">"SELECT * "</span> <span class="o">+</span> 
            <span class="s">"FROM   UNETI_PREDMETI"</span><span class="o">;</span>
        <span class="nc">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">createStatement</span><span class="o">(</span> 
                <span class="c1">// Dovoljan nam je kursor koji prolazi unapred kroz redove.</span>
                <span class="nc">ResultSet</span><span class="o">.</span><span class="na">TYPE_FORWARD_ONLY</span><span class="o">,</span>
                <span class="c1">// Definisemo da je kursor azurirajuci,</span>
                <span class="c1">// pa su nam dostupni metodi</span>
                <span class="c1">// ResultSet.updateXXX i ResultSet.insertRow</span>
                <span class="c1">// koje cemo koristiti za konstrukciju i unos novog reda</span>
                <span class="nc">ResultSet</span><span class="o">.</span><span class="na">CONCUR_UPDATABLE</span><span class="o">);</span>
        <span class="nc">ResultSet</span> <span class="n">kursor</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
        <span class="nc">Scanner</span> <span class="n">ulaz</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Scanner</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
        
        <span class="k">for</span> <span class="o">(</span><span class="nc">StatistikaPolaganja</span> <span class="n">statistika</span> <span class="o">:</span> <span class="n">statistike</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// Pozicioniramo kursor na "slog za unos"</span>
            <span class="n">kursor</span><span class="o">.</span><span class="na">moveToInsertRow</span><span class="o">();</span>
            <span class="c1">// Konstruisemo "slog za unos" navodjenjem vrednost za svaku kolonu</span>
            <span class="n">kursor</span><span class="o">.</span><span class="na">updateInt</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">statistika</span><span class="o">.</span><span class="na">id_predmeta</span><span class="o">);</span>
            <span class="n">kursor</span><span class="o">.</span><span class="na">updateInt</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">statistika</span><span class="o">.</span><span class="na">broj_polaganja</span><span class="o">);</span>
            <span class="c1">// Izvrsavamo ili ponistavamo unos u zavisnosti od korisnikovog odgovora</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Da li zelite da unete statistiku za predmet "</span> <span class="o">+</span> <span class="n">statistika</span><span class="o">.</span><span class="na">id_predmeta</span> <span class="o">+</span> <span class="s">"? [da/ne]"</span><span class="o">);</span>
            <span class="nc">String</span> <span class="n">odgovor</span> <span class="o">=</span> <span class="n">ulaz</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">odgovor</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="s">"da"</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">kursor</span><span class="o">.</span><span class="na">insertRow</span><span class="o">();</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"\tUneta je statistika: "</span> <span class="o">+</span> <span class="n">statistika</span><span class="o">.</span><span class="na">id_predmeta</span> <span class="o">+</span> <span class="s">" ("</span> <span class="o">+</span> <span class="n">statistika</span><span class="o">.</span><span class="na">broj_polaganja</span> <span class="o">+</span> <span class="s">")"</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">else</span> <span class="o">{</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"\tPonistili ste unos!"</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="c1">// Vracamo kursor na zapamceni tekuci red</span>
            <span class="n">kursor</span><span class="o">.</span><span class="na">moveToCurrentRow</span><span class="o">();</span>
        <span class="o">}</span>
        
        <span class="n">ulaz</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">kursor</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="838-brisanje-redova-korišćenjem-resultset-kursora">8.3.8 Brisanje redova korišćenjem ResultSet kursora</h3>

<p>Poput ažuriranja podataka, i za brisanje podataka postoje dve procedure:</p>

<ul>
  <li>Korišćenjem pozicionirajuće <code class="language-plaintext highlighter-rouge">DELETE</code> naredbe.</li>
  <li>Korišćenjem JDBC metoda <code class="language-plaintext highlighter-rouge">deleteRow</code>.</li>
</ul>

<p>Kao što znamo, možemo koristiti pozicionirajuću DELETE naredbu za brisanje podataka iz
baze podataka, na osnovu tekućeg reda kursora, tako što se na kursor referiše u <code class="language-plaintext highlighter-rouge">WHERE CURRENT OF</code> klauzi naredbe. Procedura za dohvatanje naziva kursora i izvršavanje pozicionirajuće <code class="language-plaintext highlighter-rouge">DELETE</code> naredbe je ekvivalentna prethodno opisanoj proceduri za ažuriranje podataka korišćenjem pozicionirajuće <code class="language-plaintext highlighter-rouge">UPDATE</code> naredbe, te ćemo samo prikazati fragment koda koji ilustruje ovu proceduru:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">upit</span> <span class="o">=</span>
    <span class="s">"SELECT SIFRA, "</span> <span class="o">+</span>
    <span class="s">"       NAZIV, "</span> <span class="o">+</span> 
    <span class="s">"       BODOVI "</span> <span class="o">+</span>
    <span class="s">"FROM   PREDMET"</span><span class="o">;</span>

<span class="nc">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
<span class="nc">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">(</span><span class="n">upit</span><span class="o">);</span>

<span class="nc">String</span> <span class="n">nazivKursora</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="na">getCursorName</span><span class="o">();</span>
<span class="nc">String</span> <span class="n">brisanje</span> <span class="o">=</span>
    <span class="s">"DELETE FROM ISPIT "</span> <span class="o">+</span>
    <span class="s">"WHERE  CURRENT OF "</span> <span class="o">+</span> <span class="n">nazivKursora</span><span class="o">;</span>
<span class="nc">Statement</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">();</span>

<span class="k">while</span> <span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">nazivPredmeta</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>

    <span class="n">ps</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">(</span><span class="n">brisanje</span><span class="o">);</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Obrisan je predmet "</span> <span class="o">+</span> <span class="n">nazivPredmeta</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Brisanje sloga iz objekta <code class="language-plaintext highlighter-rouge">ResultSet</code> je jednostavnije nego ažuriranje ili unos sloga. Naredni koraci definišu operaciju brisanja sloga iz kursora:</p>

<ol>
  <li>Kreirati objekat interfejsa <code class="language-plaintext highlighter-rouge">Statement</code> pozivom metoda
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">createStatement</span><span class="o">(...,</span> <span class="nc">ResultSet</span><span class="o">.</span><span class="na">CONCUR_UPDATABLE</span><span class="o">,</span> <span class="o">...);</span>
</code></pre></div>    </div>
  </li>
  <li>Kreirati objekat interfejsa <code class="language-plaintext highlighter-rouge">ResultSet</code> pozivom metoda
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">ResultSet</span> <span class="n">kursor</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
  <li>Pozicionirati se na slog koji je potrebno obrisati metodima za prolazak kroz kursor. Na primer:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">while</span> <span class="o">(</span><span class="n">kursor</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
 <span class="c1">// ...</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>Pozvati metod <code class="language-plaintext highlighter-rouge">kursor.deleteRow()</code> koji će obrisati slog u bazi podataka</li>
  <li>Nakon svih iteracija, pozvati metod <code class="language-plaintext highlighter-rouge">kursor.close()</code> radi zatvaranja kursora</li>
  <li>Nakon zatvaranja kursora, pozvati metod <code class="language-plaintext highlighter-rouge">stmt.close()</code> radi zatvaranja objekta naredbe</li>
</ol>

<p>The <code class="language-plaintext highlighter-rouge">deleteRow()</code> method deletes the row from the <code class="language-plaintext highlighter-rouge">ResultSet</code> and, at the same time, it
deletes the row from the database. There is no way to cancel the delete operation except
by rolling back the transaction. If the auto-commit mode is enabled on the <code class="language-plaintext highlighter-rouge">Connection</code>,
<code class="language-plaintext highlighter-rouge">deleteRow()</code> will permanently delete the row from the database.</p>

<div style="border: 2px solid rgb(196, 41, 255); padding: 5px; background-color: rgba(197, 197, 197, 0.3); margin: 10px 0;">
    <p style="font-weight: bold;">Zadatak 8.9</p>
    Napisati Java program u kojem se naredbe izvršavaju dinamički koji briše sve nepoložene ispite u godini koja se zadaje sa standarnog ulaza. Nakon svakog brisanja ispita, ispisati naredne informacije o njemu na standardni izlaz: indeks, oznaku roka, godinu roka i identifikator predmeta.
</div>

<p>Rešenje:</p>

<p>Datoteka: <code class="language-plaintext highlighter-rouge">primeri/poglavlje_8/src/zadatak_8_9/Main.java</code>:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">zadatak_8_9</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.sql.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"com.ibm.db2.jcc.DB2Driver"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span> <span class="n">argv</span><span class="o">[])</span> <span class="o">{</span>
    	<span class="nc">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"jdbc:db2://localhost:50001/vstud"</span><span class="o">;</span>

        <span class="k">try</span> <span class="o">(</span><span class="nc">Connection</span> <span class="n">con</span> <span class="o">=</span> <span class="nc">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="s">"student"</span><span class="o">,</span> <span class="s">"abcdef"</span><span class="o">))</span> <span class="o">{</span>
            
            <span class="n">izbrisi_nepolozene_ispite</span><span class="o">(</span><span class="n">con</span><span class="o">);</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">SQLException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"SQLCODE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getErrorCode</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span> <span class="s">"SQLSTATE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getSQLState</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span>
                    <span class="o">+</span> <span class="s">"PORUKA: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">izbrisi_nepolozene_ispite</span><span class="o">(</span><span class="nc">Connection</span> <span class="n">con</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">SQLException</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">godina</span> <span class="o">=</span> <span class="n">ucitaj_godinu</span><span class="o">();</span>
        
        <span class="nc">String</span> <span class="n">selectSql</span> <span class="o">=</span> 
            <span class="s">"SELECT INDEKS, "</span> <span class="o">+</span> 
            <span class="s">"       OZNAKA_ROKA, "</span> <span class="o">+</span> 
            <span class="s">"       ID_PREDMETA "</span> <span class="o">+</span>
            <span class="s">"FROM   ISPIT "</span> <span class="o">+</span>
            <span class="s">"WHERE  GODINA_ROKA= ? AND "</span> <span class="o">+</span>   
            <span class="s">"       OCENA = 5 AND "</span> <span class="o">+</span>  
            <span class="s">"       STATUS_PRIJAVE = 'o'"</span><span class="o">;</span>    
        <span class="nc">PreparedStatement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">selectSql</span><span class="o">,</span>
            <span class="nc">ResultSet</span><span class="o">.</span><span class="na">TYPE_FORWARD_ONLY</span><span class="o">,</span>
            <span class="c1">// Podesavamo kursor da bude za menjanje,</span>
            <span class="c1">// da bi smo mogli da brisemo redove metodom deleteRow() .</span>
            <span class="nc">ResultSet</span><span class="o">.</span><span class="na">CONCUR_UPDATABLE</span><span class="o">);</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">godina</span><span class="o">);</span>
        <span class="nc">ResultSet</span> <span class="n">ispiti</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">();</span>
        
        <span class="k">while</span><span class="o">(</span><span class="n">ispiti</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">indeks</span> <span class="o">=</span> <span class="n">ispiti</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
            <span class="nc">String</span> <span class="n">oznaka_roka</span> <span class="o">=</span> <span class="n">ispiti</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="na">trim</span><span class="o">();</span>
            <span class="kt">int</span> <span class="n">id_predmeta</span> <span class="o">=</span> <span class="n">ispiti</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
            
            <span class="n">ispiti</span><span class="o">.</span><span class="na">deleteRow</span><span class="o">();</span>
            
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"Obrisan je ispit %-10d %-10s %-5d %-10d\n"</span><span class="o">,</span> 
                <span class="n">indeks</span><span class="o">,</span> <span class="n">oznaka_roka</span><span class="o">,</span> <span class="n">godina</span><span class="o">,</span> <span class="n">id_predmeta</span><span class="o">);</span>
        <span class="o">}</span>
        
        <span class="n">ispiti</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">ucitaj_godinu</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">godina</span><span class="o">;</span>
        
        <span class="k">try</span> <span class="o">(</span><span class="nc">Scanner</span> <span class="n">ulaz</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Scanner</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">))</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Unesite godinu roka za koju zelite da budu obrisani nepolozeni ispiti:"</span><span class="o">);</span>
            <span class="n">godina</span> <span class="o">=</span> <span class="n">ulaz</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
        <span class="o">}</span>
        
        <span class="k">return</span> <span class="n">godina</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="839-ugnežđeni-kursori">8.3.9 Ugnežđeni kursori</h3>

<p>U JDBC aplikacijama se kursori jednostavno ugnežđuju: potrebno je celokupnu obradu
unutrašnjeg kursora smestiti u okviru obrade jednog reda iz spoljašnjeg kursora. Naredni
primer ilustruje upotrebu ugnežđenih kursora.</p>

<div style="border: 2px solid rgb(196, 41, 255); padding: 5px; background-color: rgba(197, 197, 197, 0.3); margin: 10px 0;">
    <p style="font-weight: bold;">Zadatak 8.10</p>
    Napisati Java program u kojem se naredbe izvršavaju dinamički koji izdvaja indeks, ime, prezime i naziv smera svih studenata koji su položili tačno N predmeta, kao i spisak tih predmeta (naziv i ocena). Broj N se učitava sa standardnog ulaza. Za svakog studenta napraviti posebnu sekciju izveštaja.
</div>

<p>Rešenje:</p>

<p>Datoteka: <code class="language-plaintext highlighter-rouge">primeri/poglavlje_8/src/zadatak_8_10/ispiti.sql</code>:</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>      <span class="n">D</span><span class="p">.</span><span class="n">INDEKS</span><span class="p">,</span> 
            <span class="k">TRIM</span><span class="p">(</span><span class="n">IME</span><span class="p">),</span>
            <span class="k">TRIM</span><span class="p">(</span><span class="n">PREZIME</span><span class="p">),</span> 
            <span class="k">TRIM</span><span class="p">(</span><span class="n">NAZIV</span><span class="p">)</span>
<span class="k">FROM</span>        <span class="n">DOSIJE</span> <span class="n">D</span> <span class="k">JOIN</span> 
            <span class="n">SMER</span> <span class="n">S</span> <span class="k">ON</span> <span class="n">D</span><span class="p">.</span><span class="n">ID_SMERA</span> <span class="o">=</span> <span class="n">S</span><span class="p">.</span><span class="n">ID_SMERA</span> <span class="k">JOIN</span> 
            <span class="n">ISPIT</span> <span class="n">I</span> <span class="k">ON</span> <span class="n">D</span><span class="p">.</span><span class="n">INDEKS</span> <span class="o">=</span> <span class="n">I</span><span class="p">.</span><span class="n">INDEKS</span>
<span class="k">WHERE</span>       <span class="n">OCENA</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="k">AND</span> 
            <span class="n">STATUS_PRIJAVE</span> <span class="o">=</span> <span class="s1">'o'</span>
<span class="k">GROUP</span> <span class="k">BY</span>    <span class="n">D</span><span class="p">.</span><span class="n">INDEKS</span><span class="p">,</span> 
            <span class="n">IME</span><span class="p">,</span> 
            <span class="n">PREZIME</span><span class="p">,</span> 
            <span class="n">NAZIV</span>
<span class="k">HAVING</span>      <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">=</span> <span class="o">?</span>
</code></pre></div></div>
<p>Datoteka: <code class="language-plaintext highlighter-rouge">primeri/poglavlje_8/src/zadatak_8_10/predmeti.sql</code>:</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>      <span class="k">TRIM</span><span class="p">(</span><span class="n">NAZIV</span><span class="p">),</span> 
            <span class="n">OCENA</span> 
<span class="k">FROM</span>        <span class="n">ISPIT</span> <span class="n">I</span> <span class="k">JOIN</span> 
            <span class="n">PREDMET</span> <span class="n">P</span> <span class="k">ON</span> <span class="n">I</span><span class="p">.</span><span class="n">ID_PREDMETA</span> <span class="o">=</span> <span class="n">P</span><span class="p">.</span><span class="n">ID_PREDMETA</span> 
<span class="k">WHERE</span>       <span class="n">I</span><span class="p">.</span><span class="n">INDEKS</span> <span class="o">=</span> <span class="o">?</span> <span class="k">AND</span> 
            <span class="n">OCENA</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="k">AND</span> 
            <span class="n">STATUS_PRIJAVE</span> <span class="o">=</span> <span class="s1">'o'</span>
<span class="k">ORDER</span> <span class="k">BY</span>    <span class="n">NAZIV</span>
</code></pre></div></div>
<p>Datoteka: <code class="language-plaintext highlighter-rouge">primeri/poglavlje_8/src/zadatak_8_10/Main.java</code>:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">zadatak_8_10</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileNotFoundException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"com.ibm.db2.jcc.DB2Driver"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span> <span class="n">argv</span><span class="o">[])</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"jdbc:db2://localhost:50001/vstud"</span><span class="o">;</span>

        <span class="k">try</span> <span class="o">(</span><span class="nc">Connection</span> <span class="n">con</span> <span class="o">=</span> <span class="nc">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="s">"student"</span><span class="o">,</span> <span class="s">"abcdef"</span><span class="o">))</span> <span class="o">{</span>
        	
            <span class="n">prodji_kroz_spoljasnji_kursor</span><span class="o">(</span><span class="n">con</span><span class="o">);</span>
            
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">SQLException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"SQLCODE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getErrorCode</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span> <span class="s">"SQLSTATE: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getSQLState</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span>
                    <span class="o">+</span> <span class="s">"PORUKA: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">prodji_kroz_spoljasnji_kursor</span><span class="o">(</span><span class="nc">Connection</span> <span class="n">con</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">SQLException</span><span class="o">,</span> <span class="nc">FileNotFoundException</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">ukupnoPredmeta</span> <span class="o">=</span> <span class="n">ucitaj_broj_predmeta</span><span class="o">();</span>

        <span class="nc">PreparedStatement</span> <span class="n">pstmt</span><span class="o">;</span>

        <span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="n">ucitajSqlIzDatoteke</span><span class="o">(</span><span class="s">"ispiti.sql"</span><span class="o">);</span>
        <span class="n">pstmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>

        <span class="n">pstmt</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">ukupnoPredmeta</span><span class="o">);</span>
        <span class="nc">ResultSet</span> <span class="n">ispiti</span> <span class="o">=</span> <span class="n">pstmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">();</span>

        <span class="k">while</span> <span class="o">(</span><span class="n">ispiti</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"\n\nIndeks: %-10d\nIme: %-10s\nPrezime: %-20s\nNaziv smera: %-30s\n\n"</span><span class="o">,</span> <span class="n">ispiti</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span>
                    <span class="n">ispiti</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">2</span><span class="o">),</span> <span class="n">ispiti</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">3</span><span class="o">),</span> <span class="n">ispiti</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">4</span><span class="o">));</span>

            <span class="kt">int</span> <span class="n">indeks</span> <span class="o">=</span> <span class="n">ispiti</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
            <span class="n">prodji_kroz_unutrasnji_kursor</span><span class="o">(</span><span class="n">con</span><span class="o">,</span> <span class="n">indeks</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="n">ispiti</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">pstmt</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">prodji_kroz_unutrasnji_kursor</span><span class="o">(</span><span class="nc">Connection</span> <span class="n">con</span><span class="o">,</span> <span class="kt">int</span> <span class="n">indeks</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">SQLException</span><span class="o">,</span> <span class="nc">FileNotFoundException</span> <span class="o">{</span>
        <span class="nc">PreparedStatement</span> <span class="n">pstmt</span><span class="o">;</span>

        <span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="n">ucitajSqlIzDatoteke</span><span class="o">(</span><span class="s">"predmeti.sql"</span><span class="o">);</span>
        <span class="n">pstmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>

        <span class="n">pstmt</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">indeks</span><span class="o">);</span>
        <span class="nc">ResultSet</span> <span class="n">predmeti</span> <span class="o">=</span> <span class="n">pstmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">();</span>

        <span class="kt">int</span> <span class="n">redniBr</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>

        <span class="k">while</span> <span class="o">(</span><span class="n">predmeti</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"\t%d. predmet: %s\n\t\tOcena: %d\n"</span><span class="o">,</span> <span class="n">redniBr</span><span class="o">,</span> <span class="n">predmeti</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span>
                    <span class="n">predmeti</span><span class="o">.</span><span class="na">getShort</span><span class="o">(</span><span class="mi">2</span><span class="o">));</span>

            <span class="o">++</span><span class="n">redniBr</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="n">predmeti</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">pstmt</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">ucitaj_broj_predmeta</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">godina</span><span class="o">;</span>

        <span class="k">try</span> <span class="o">(</span><span class="nc">Scanner</span> <span class="n">ulaz</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Scanner</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">))</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Unesite broj predmeta N:"</span><span class="o">);</span>
            <span class="n">godina</span> <span class="o">=</span> <span class="n">ulaz</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">godina</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">ucitajSqlIzDatoteke</span><span class="o">(</span><span class="nc">String</span> <span class="n">nazivDatoteke</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">FileNotFoundException</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">putanja</span> <span class="o">=</span> <span class="s">"./bin/zadatak_8_10/"</span> <span class="o">+</span> <span class="n">nazivDatoteke</span><span class="o">;</span>
        <span class="nc">StringBuilder</span> <span class="n">sql</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">linija</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        
        <span class="k">try</span> <span class="o">(</span><span class="nc">Scanner</span> <span class="n">skenerFajla</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Scanner</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">putanja</span><span class="o">),</span> <span class="s">"utf-8"</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">skenerFajla</span><span class="o">.</span><span class="na">hasNextLine</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">linija</span> <span class="o">=</span> <span class="n">skenerFajla</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>
                <span class="n">sql</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">linija</span><span class="o">);</span>
                <span class="n">sql</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"\n"</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">sql</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="84-zadaci-za-vežbu">8.4 Zadaci za vežbu</h2>

<div style="border: 2px solid rgb(196, 41, 255); padding: 5px; background-color: rgba(197, 197, 197, 0.3); margin: 10px 0;">
    <p style="font-weight: bold;">Zadatak 8.11</p>
    Napisati Java program u kojem se naredbe izvršavaju dinamički koji ispisuje podatke za predmet čiji je identifikator <span style="color: #e83e8c; background-color: #eef; padding: 1px 5px; font-family: SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;">640</span>.
</div>

<div style="border: 2px solid rgb(196, 41, 255); padding: 5px; background-color: rgba(197, 197, 197, 0.3); margin: 10px 0;">
    <p style="font-weight: bold;">Zadatak 8.12</p>
    Napisati Java program u kojem se naredbe izvršavaju dinamički koji ispisuje broj studenata koji su upisali studije u godini koja se unosi sa standardnog ulaza.
</div>

<div style="border: 2px solid rgb(196, 41, 255); padding: 5px; background-color: rgba(197, 197, 197, 0.3); margin: 10px 0;">
    <p style="font-weight: bold;">Zadatak 8.13</p>
    Napisati Java program u kojem se naredbe izvršavaju dinamički koji za svaku ocenu od 6 do 10 ispisuje ime i prezime studenta koji je poslednji položio neki ispit sa tom ocenom. U slučaju da ima više takvih studenata, klauzom <span style="color: #e83e8c; background-color: #eef; padding: 1px 5px; font-family: SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;">LIMIT 1</span> naredbe <span style="color: #e83e8c; background-color: #eef; padding: 1px 5px; font-family: SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;">SELECT INTO</span> se osigurati da rezultat vrati najviše 1 rezultat. (Pomoć: Koristiti <span style="color: #e83e8c; background-color: #eef; padding: 1px 5px; font-family: SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;">for</span> petlju za menjanje vrednosti matične promenljive koja sadrži ocenu, pa u svakoj iteraciji dohvatiti informaciju za tekuću vrednost te matične promenljive.)
</div>

<div style="border: 2px solid rgb(196, 41, 255); padding: 5px; background-color: rgba(197, 197, 197, 0.3); margin: 10px 0;">
    <p style="font-weight: bold;">Zadatak 8.14</p>
    Napisati Java program u kojem se naredbe izvršavaju dinamički kojim se dodaje da je za polaganje predmeta čiji je identifikator <span style="color: #e83e8c; background-color: #eef; padding: 1px 5px; font-family: SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;">720</span> uslov da se položi predmet čiji je identifikator <span style="color: #e83e8c; background-color: #eef; padding: 1px 5px; font-family: SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;">655</span>.
</div>

<div style="border: 2px solid rgb(196, 41, 255); padding: 5px; background-color: rgba(197, 197, 197, 0.3); margin: 10px 0;">
    <p style="font-weight: bold;">Zadatak 8.15</p>
    Napisati Java program u kojem se naredbe izvršavaju dinamički kojim se u tabelu <span style="color: #e83e8c; background-color: #eef; padding: 1px 5px; font-family: SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;">NIVO_KVALIFIKACIJE</span> dodaje novi nivo čiji se identifikator, naziv i stepen unose sa standardnog ulaza.
</div>

<div style="border: 2px solid rgb(196, 41, 255); padding: 5px; background-color: rgba(197, 197, 197, 0.3); margin: 10px 0;">
    <p style="font-weight: bold;">Zadatak 8.16</p>
    Napisati Java program u kojem se naredbe izvršavaju dinamički kojim se svim obaveznim predmetima na smeru <span style="color: #e83e8c; background-color: #eef; padding: 1px 5px; font-family: SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;">'Informatika'</span> povećava broj semestra za 1.
</div>

<div style="border: 2px solid rgb(196, 41, 255); padding: 5px; background-color: rgba(197, 197, 197, 0.3); margin: 10px 0;">
    <p style="font-weight: bold;">Zadatak 8.17</p>
    Napisati Java program u kojem se naredbe izvršavaju dinamički kojim se, za sve položene ispite čiji se naziv predmeta unosi sa standardnog ulaza, ocena uvećava za 1.
</div>

<div style="border: 2px solid rgb(196, 41, 255); padding: 5px; background-color: rgba(197, 197, 197, 0.3); margin: 10px 0;">
    <p style="font-weight: bold;">Zadatak 8.18</p>
    Napisati Java program u kojem se naredbe izvršavaju dinamički kojim se u tabeli <span style="color: #e83e8c; background-color: #eef; padding: 1px 5px; font-family: SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;">USLOVNI_PREDMET</span> brišu svi redovi koji se odnose na predmete koji su uslovni da bi se položio predmet čiji se identifikator unosi sa standardnog ulaza.
</div>

<div style="border: 2px solid rgb(196, 41, 255); padding: 5px; background-color: rgba(197, 197, 197, 0.3); margin: 10px 0;">
    <p style="font-weight: bold;">Zadatak 8.19</p>
    Napisati Java program u kojem se naredbe izvršavaju dinamički kojim se brišu svi podaci o ispitima za studenta čiji se indeks unosi sa standardnog ulaza.
</div>

<div style="border: 2px solid rgb(196, 41, 255); padding: 5px; background-color: rgba(197, 197, 197, 0.3); margin: 10px 0;">
    <p style="font-weight: bold;">Zadatak 8.20</p>
    Napisati Java program u kojem se naredbe izvršavaju dinamički koji iz tabele <span style="color: #e83e8c; background-color: #eef; padding: 1px 5px; font-family: SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;">PREDMET</span> briše podatak o predmetu čija se šifra unosi sa standardnog ulaza. 
</div>

  </div>

</article>

        </div>
    </main><footer class="site-footer h-card">
    <data class="u-url" href="/PDb2BP/"></data>

    <div class="wrapper">

        <div class="row">
            <h2 class="footer-heading">Programiranje Db2 baza podataka</h2>
        </div>

        <div class="footer-col-wrapper">
            <div class="row">
                <div class="col-6">
                    <ul class="contact-list">
                        <li class="p-name">Programiranje Db2 baza podataka</li><li><a class="u-email" href="mailto:nikola_ajzenhamer@math.rs">nikola_ajzenhamer@math.rs</a></li></ul>
                </div>
                <div class="col-6">
                    <p>Elektronska knjiga &quot;Programiranje Db2 baza podataka&quot; dostupna besplatno na adresi&nbsp;<a
                            href="/PDb2BP/">https://theikeofficial.github.io//PDb2BP/</a>.</p>
                </div>
            </div>
        </div>

    </div>

</footer><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
</body>

</html>